<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.4</version>
    <date>2020-01-24T07:14:38Z</date>
    <groups>
        <group>
            <name>DBS.Templates/Databases</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>DBS_Template MySQL for Windows</template>
            <name>DBS_Template MySQL for Windows</name>
            <groups>
                <group>
                    <name>DBS.Templates/Databases</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>MySQL: Connections</name>
                </application>
                <application>
                    <name>MySQL: Info</name>
                </application>
                <application>
                    <name>MySQL: Performance</name>
                </application>
                <application>
                    <name>MySQL: Throughput</name>
                </application>
                <application>
                    <name>MySQL: Variables</name>
                </application>
                <application>
                    <name>stubs</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Log of '{$DBS_MYSQL_ERROR_LOG}'</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>logrt[&quot;{$DBS_MYSQL_ERROR_LOG}&quot;,&quot;PANIC|FATAL|ERROR|[Ee]rror&quot;]</key>
                    <trends>0</trends>
                    <value_type>LOG</value_type>
                    <applications>
                        <application>
                            <name>MySQL: Info</name>
                        </application>
                    </applications>
                    <logtimefmt>yyyy-MM-ddThh:mm:ss</logtimefmt>
                    <triggers>
                        <trigger>
                            <expression>{iregexp(InnoDB)}=1</expression>
                            <name>{{ITEM.VALUE}.iregsub(&quot;InnoDB: ([a-zA-Z0-9 &gt;]+)&quot;, &quot;Fatal error in MySQL InnoDB (Error: '\1')&quot;)}</name>
                            <priority>HIGH</priority>
                            <description>В лог-файле &quot;{$DBS_MYSQL_ERROR_LOG}&quot; обнаружена критическая ошибка в работе InnoDB, как можно скорее просмотрите лог-файл на сервере, передайте информацию эксперту.</description>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>MySQL</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_MYSQL_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Get database info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>mysql.db.info[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    <delay>30m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Get global status</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Get global variables</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>mysql.global.variables[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    <delay>30m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Server ID</name>
                    <type>DEPENDENT</type>
                    <key>mysql.instance[{$DBS_MYSQL_INSTANCE},server_id]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>This variable specifies the server ID. In MySQL 5.7, server_id must be specified if binary logging is enabled, otherwise the server is not allowed to start.</description>
                    <applications>
                        <application>
                            <name>MySQL: Info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.SERVER_ID</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.server.info[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Startup time</name>
                    <type>DEPENDENT</type>
                    <key>mysql.instance[{$DBS_MYSQL_INSTANCE},startup_time]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <units>unixtime</units>
                    <description>The time at which MySQL was started.</description>
                    <applications>
                        <application>
                            <name>MySQL: Info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.STARTUPTIME</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.server.info[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': UUID</name>
                    <type>DEPENDENT</type>
                    <key>mysql.instance[{$DBS_MYSQL_INSTANCE},uuid]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Universal Unique Identifier (UUID).</description>
                    <applications>
                        <application>
                            <name>MySQL: Info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.SERVER_UUID</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.server.info[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Version full</name>
                    <type>DEPENDENT</type>
                    <key>mysql.instance[{$DBS_MYSQL_INSTANCE},version_full]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Full MySQL version information (number and vendor).</description>
                    <applications>
                        <application>
                            <name>MySQL: Info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.VERSION</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.server.info[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Ping</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    <history>30d</history>
                    <description>Test connection with an instance of MySQL.</description>
                    <applications>
                        <application>
                            <name>MySQL: Info</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>DBS MySQL (Instance state)</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max(#2)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#2)}=1</recovery_expression>
                            <name>Instance access failed</name>
                            <priority>DISASTER</priority>
                            <description>Тестовое подключение к экземпляру БД MySQL не успешно. Необходимо проверить работу экземпляра БД, посмотреть error.log, далее проверить работу и настройки zabbix-agent.</description>
                            <dependencies>
                                <dependency>
                                    <name>Test connection data not received for more than {$DBS_MYSQL_PING_NODATA_WARN} (minutes)</name>
                                    <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].nodata({$DBS_MYSQL_PING_NODATA_WARN})}=1</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>MySQL</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_MYSQL_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{nodata({$DBS_MYSQL_PING_NODATA_CRIT})}=1</expression>
                            <name>Test connection data not received for more than {$DBS_MYSQL_PING_NODATA_CRIT} (minutes)</name>
                            <priority>HIGH</priority>
                            <description>Данные о доступности экземпляра БД MySQL не поступали более {$DBS_MYSQL_PING_NODATA_CRIT} (минут). Необходимо проверить работу экземпляра БД, далее проверить работу и настройки zabbix-agent. Сообщить о проблеме эксперту в  соответствующий чат.</description>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>MySQL</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_MYSQL_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{nodata({$DBS_MYSQL_PING_NODATA_WARN})}=1</expression>
                            <name>Test connection data not received for more than {$DBS_MYSQL_PING_NODATA_WARN} (minutes)</name>
                            <priority>WARNING</priority>
                            <description>Данные о доступности экземпляра БД MySQL не поступали более {$DBS_MYSQL_PING_NODATA_WARN} (минут). Необходимо проверить работу экземпляра БД, далее проверить работу и настройки zabbix-agent. Сообщить о проблеме эксперту в  соответствующий чат.</description>
                            <dependencies>
                                <dependency>
                                    <name>Test connection data not received for more than {$DBS_MYSQL_PING_NODATA_CRIT} (minutes)</name>
                                    <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].nodata({$DBS_MYSQL_PING_NODATA_CRIT})}=1</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>MySQL</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_MYSQL_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Get server info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>mysql.server.info[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    <delay>1h</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Aborted clients per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},aborted_clients_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>The number of connections that were aborted because the client died without closing the connection properly.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.ABORTED_CLIENTS</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Aborted connections per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},aborted_connects_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>The number of failed attempts to connect to the MySQL server.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.ABORTED_CONNECTS</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{min(5m)}&gt;{$DBS_MYSQL_ABORTED_CONN_MAX_WARN}</expression>
                            <name>Server has aborted connections</name>
                            <opdata>(current: {ITEM.LASTVALUE1}, over {$DBS_MYSQL_ABORTED_CONN_MAX_WARN} for 5m, alert started {ITEM.VALUE1})</opdata>
                            <priority>AVERAGE</priority>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Refused connections (max_connections limit reached)</name>
                                    <expression>{DBS_Template MySQL for Windows:mysql.status[{$DBS_MYSQL_INSTANCE},connection_errors_max_connections_rate].last()}&gt;0</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>MySQL</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_MYSQL_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Buffer pool dirty</name>
                    <type>CALCULATED</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},buffer_pool_dirty_ratio]</key>
                    <delay>2m</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_dirty]&quot;) / ( last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_total]&quot;) + (last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_total]&quot;) = 0)) * 100 * (last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_total]&quot;) &gt; 0)</params>
                    <description>Ratio of total to dirty pages in the buffer pool.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Buffer pool efficiency</name>
                    <type>CALCULATED</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},buffer_pool_efficiency]</key>
                    <delay>2m</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_reads]&quot;) / (last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_read_requests]&quot;) + (last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_read_requests]&quot;) = 0 ) ) * 100 * (last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_read_requests]&quot;) &gt; 0 )</params>
                    <description>The item shows how effectively the buffer pool is serving reads.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Buffer pool utilization</name>
                    <type>CALCULATED</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},buffer_pool_utilization]</key>
                    <delay>2m</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>( last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_total]&quot;) - last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_free]&quot;) ) / ( last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_total]&quot;) + (last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_total]&quot;) = 0)) * 100 * (last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_total]&quot;) &gt; 0)</params>
                    <description>Ratio of used to total pages in the buffer pool.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Bytes received</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},bytes_received_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <units>Bps</units>
                    <description>The number of bytes received from all clients.</description>
                    <applications>
                        <application>
                            <name>MySQL: Throughput</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.BYTES_RECEIVED</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Bytes sent</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},bytes_sent_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <units>Bps</units>
                    <description>The number of bytes sent to all clients.</description>
                    <applications>
                        <application>
                            <name>MySQL: Throughput</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.BYTES_SENT</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Command Delete per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},com_delete_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>The Com_delete counter variable indicates the number of times the delete statement has been executed.</description>
                    <applications>
                        <application>
                            <name>MySQL: Throughput</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.COM_DELETE</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Command Insert per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},com_insert_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>The Com_insert counter variable indicates the number of times the insert statement has been executed.</description>
                    <applications>
                        <application>
                            <name>MySQL: Throughput</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.COM_INSERT</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Command Select</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},com_select]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The Com_select counter variable indicates the number of times the select statement has been executed.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.COM_SELECT</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Command Select per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},com_select_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>The Com_select counter variable indicates the number of times the select statement has been executed.</description>
                    <applications>
                        <application>
                            <name>MySQL: Throughput</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.COM_SELECT</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Command Update per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},com_update_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>The Com_update counter variable indicates the number of times the update statement has been executed.</description>
                    <applications>
                        <application>
                            <name>MySQL: Throughput</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.COM_UPDATE</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Connections per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},connections_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>The number of connection attempts (successful or not) to the MySQL server.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.CONNECTIONS</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Connection errors accept per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},connection_errors_accept_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>Number of errors that occurred during calls to accept() on the listening port.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.CONNECTION_ERRORS_ACCEPT</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Connection errors internal per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},connection_errors_internal_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>Number of refused connections due to internal server errors, for example out of memory errors, or failed thread starts.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.CONNECTION_ERRORS_INTERNAL</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Connection errors max connections per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},connection_errors_max_connections_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>Number of refused connections due to the max_connections limit being reached.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.CONNECTION_ERRORS_MAX_CONNECTIONS</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;0</expression>
                            <name>Refused connections (max_connections limit reached)</name>
                            <priority>AVERAGE</priority>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>MySQL</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_MYSQL_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Connection errors peer address per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},connection_errors_peer_address_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>Number of errors while searching for the connecting client IP address.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.CONNECTION_ERRORS_PEER_ADDRESS</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Connection errors select per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},connection_errors_select_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>Number of errors during calls to select() or poll() on the listening port. The client would not necessarily have been rejected in these cases.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.CONNECTION_ERRORS_SELECT</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Connection errors tcpwrap per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},connection_errors_tcpwrap_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>Number of connections the libwrap library refused.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.CONNECTION_ERRORS_TCPWRAP</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Created tmp tables on disk</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},created_tmp_disk_tables]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of internal on-disk temporary tables created by the server while executing statements.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.CREATED_TMP_DISK_TABLES</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Created tmp files on disk</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},created_tmp_files]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>How many temporary files mysqld has created.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.CREATED_TMP_FILES</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Created tmp tables on memory</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},created_tmp_tables]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of internal temporary tables created by the server while executing statements.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.CREATED_TMP_TABLES</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: InnoDB buffer pool dirty pages</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_dirty]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The current number of dirty pages in the InnoDB buffer pool.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.INNODB_BUFFER_POOL_PAGES_DIRTY</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: InnoDB buffer pool pages free</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_free]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of free pages in the InnoDB buffer pool.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.INNODB_BUFFER_POOL_PAGES_FREE</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: InnoDB buffer pool pages total</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_total]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The total size of the InnoDB buffer pool, in pages.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.INNODB_BUFFER_POOL_PAGES_TOTAL</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: InnoDB buffer pool reads</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_reads]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of logical reads that InnoDB could not satisfy from the buffer pool, and had to read directly from disk.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.INNODB_BUFFER_POOL_READS</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: InnoDB buffer pool read requests</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_read_requests]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of logical read requests.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.INNODB_BUFFER_POOL_READ_REQUESTS</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: InnoDB row lock time</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},innodb_row_lock_time]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>The total time spent in acquiring row locks for InnoDB tables, in milliseconds.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.INNODB_ROW_LOCK_TIME</params>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.001</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: InnoDB row lock time max</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},innodb_row_lock_time_max]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <description>The maximum time to acquire a row lock for InnoDB tables, in milliseconds.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.INNODB_ROW_LOCK_TIME_MAX</params>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.001</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: InnoDB row lock waits</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},innodb_row_lock_waits]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of times operations on InnoDB tables had to wait for a row lock.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.INNODB_ROW_LOCK_WAITS</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Max used connections</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},max_used_connections]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The maximum number of connections that have been in use simultaneously since the server started.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.MAX_USED_CONNECTIONS</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Open files</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},open_files]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of files that are open. This count includes regular files opened by the server. It does not include other types of files such as sockets or pipes. Also, the count does not include files that storage engines open using their own internal functions rather than asking the server level to do so.</description>
                    <applications>
                        <application>
                            <name>MySQL: Info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.OPEN_FILES</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Open tables</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},open_tables]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of tables that are open.</description>
                    <applications>
                        <application>
                            <name>MySQL: Info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.OPEN_TABLES</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Query cache efficiency</name>
                    <type>CALCULATED</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},qcache_efficiency]</key>
                    <delay>2m</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},qcache_hits]&quot;) / (last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},com_select]&quot;) + last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},qcache_hits]&quot;)) * 100</params>
                    <description>Query cache efficiency in percentage.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Query cache efficiency (2)</name>
                    <type>CALCULATED</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},qcache_efficiency_2]</key>
                    <delay>2m</delay>
                    <history>30d</history>
                    <status>DISABLED</status>
                    <value_type>FLOAT</value_type>
                    <units>%</units>
                    <params>(last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},qcache_hits]&quot;) / (last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},qcache_hits]&quot;) + last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},qcache_inserts]&quot;) + last(&quot;mysql.status[{$DBS_MYSQL_INSTANCE},qcache_not_cached]&quot;))) * 100</params>
                    <description>Query cache efficiency in percentage.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Query cache free memory</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},qcache_free_memory]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The amount of free memory for the query cache.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.QCACHE_FREE_MEMORY</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Query cache hits</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},qcache_hits]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of query cache hits.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.QCACHE_HITS</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Query cache inserts</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},qcache_inserts]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of queries added to the query cache.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.QCACHE_INSERTS</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Query cache lowmem prunes</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},qcache_lowmem_prunes]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of queries that were deleted from the query cache because of low memory.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.QCACHE_LOWMEM_PRUNES</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Query cache not cached</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},qcache_not_cached]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of noncached queries (not cacheable, or not cached due to the query_cache_type setting).</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.QCACHE_NOT_CACHED</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Queries per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},queries_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>The number of statements executed by the server. This variable includes statements executed within stored programs, unlike the Questions variable.</description>
                    <applications>
                        <application>
                            <name>MySQL: Throughput</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.QUERIES</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Questions per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},questions_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>The number of statements executed by the server. This includes only statements sent to the server by clients and not statements executed within stored programs, unlike the Queries variable.</description>
                    <applications>
                        <application>
                            <name>MySQL: Throughput</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.QUESTIONS</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Slow queries per second</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},slow_queries_rate]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <description>The number of queries that have taken more than long_query_time seconds. This counter increments regardless of whether the slow query log is enabled.</description>
                    <applications>
                        <application>
                            <name>MySQL: Performance</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.SLOW_QUERIES</params>
                        </step>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{min(5m)}&gt;{$DBS_MYSQL_SLOW_QUERIES_MAX_WARN}</expression>
                            <name>Server has slow queries</name>
                            <opdata>(current: {ITEM.LASTVALUE1}, over {$DBS_MYSQL_SLOW_QUERIES_MAX_WARN} for 5m, alert started {ITEM.VALUE1})</opdata>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>MySQL</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_MYSQL_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Threads cached</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},threads_cached]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of threads in the thread cache.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.THREADS_CACHED</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Threads connected</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},threads_connected]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of currently open connections.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.THREADS_CONNECTED</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Threads created</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},threads_created]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of threads created to handle connections. If Threads_created is big, you may want to increase the thread_cache_size value. The cache miss rate can be calculated as Threads_created/Connections.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.THREADS_CREATED</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Threads running</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},threads_running]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of threads that are not sleeping.</description>
                    <applications>
                        <application>
                            <name>MySQL: Connections</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.THREADS_RUNNING</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' status: Uptime</name>
                    <type>DEPENDENT</type>
                    <key>mysql.status[{$DBS_MYSQL_INSTANCE},uptime]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <units>s</units>
                    <description>The number of seconds that the server has been up.</description>
                    <applications>
                        <application>
                            <name>MySQL: Info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.UPTIME</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.status[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{change()}&lt;-5</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>Instance '{$DBS_MYSQL_INSTANCE}' has just been restarted</name>
                            <opdata>(current uptime: {ITEM.LASTVALUE}, alert started: {ITEM.VALUE})</opdata>
                            <priority>DISASTER</priority>
                            <description>Процесс (сервис) mysqld был перезапущен. Необходимо проверить факт перезапуска на сервере заказчика, проверить логи (error.log), далее уточнить в чате кто произвел перезапуск. Возможно, что перезапуск произошел в результате краха процесса в автоматическом режиме.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>MySQL</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_MYSQL_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' variable: Have query cache</name>
                    <type>DEPENDENT</type>
                    <key>mysql.variable[{$DBS_MYSQL_INSTANCE},have_query_cache]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>YES if mysqld supports the query cache, NO if not.</description>
                    <applications>
                        <application>
                            <name>MySQL: Variables</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.HAVE_QUERY_CACHE</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>6h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.variables[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' variable: Hostname</name>
                    <type>DEPENDENT</type>
                    <key>mysql.variable[{$DBS_MYSQL_INSTANCE},hostname]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Hostname</description>
                    <applications>
                        <application>
                            <name>MySQL: Variables</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.HOSTNAME</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>6h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.variables[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' variable: Max connections</name>
                    <type>DEPENDENT</type>
                    <key>mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The maximum permitted number of simultaneous client connections.</description>
                    <applications>
                        <application>
                            <name>MySQL: Variables</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.MAX_CONNECTIONS</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>6h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.variables[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' variable: Query cache limit</name>
                    <type>DEPENDENT</type>
                    <key>mysql.variable[{$DBS_MYSQL_INSTANCE},query_cache_limit]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <units>B</units>
                    <description>Do not cache results that are larger than this number of bytes. The default value is 1MB.</description>
                    <applications>
                        <application>
                            <name>MySQL: Variables</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.QUERY_CACHE_LIMIT</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>6h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.variables[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' variable: Query cache min res until</name>
                    <type>DEPENDENT</type>
                    <key>mysql.variable[{$DBS_MYSQL_INSTANCE},query_cache_min_res_unit]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <units>B</units>
                    <description>The minimum size (in bytes) for blocks allocated by the query cache. The default value is 4096 (4KB).</description>
                    <applications>
                        <application>
                            <name>MySQL: Variables</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.QUERY_CACHE_MIN_RES_UNIT</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>6h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.variables[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' variable: Query cache size</name>
                    <type>DEPENDENT</type>
                    <key>mysql.variable[{$DBS_MYSQL_INSTANCE},query_cache_size]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <units>B</units>
                    <description>The amount of memory allocated for caching query results. By default, the query cache is disabled.</description>
                    <applications>
                        <application>
                            <name>MySQL: Variables</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.QUERY_CACHE_SIZE</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>6h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.variables[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' variable: Query cache type</name>
                    <type>DEPENDENT</type>
                    <key>mysql.variable[{$DBS_MYSQL_INSTANCE},query_cache_type]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Set the query cache type.&#13;
0 or OFF - Do not cache results in or retrieve results from the query cache. Note that this does not deallocate the query cache buffer. To do that, you should set query_cache_size to 0.&#13;
1 or ON - Cache all cacheable query results except for those that begin with SELECT SQL_NO_CACHE.&#13;
2 or DEMAND - Cache results only for cacheable queries that begin with SELECT SQL_CACHE.</description>
                    <applications>
                        <application>
                            <name>MySQL: Variables</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.QUERY_CACHE_TYPE</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>6h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.variables[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}' variable: Table open cache</name>
                    <type>DEPENDENT</type>
                    <key>mysql.variable[{$DBS_MYSQL_INSTANCE},table_open_cache]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>The number of open tables for all threads. Increasing this value increases the number of file descriptors that mysqld requires.</description>
                    <applications>
                        <application>
                            <name>MySQL: Variables</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.TABLE_OPEN_CACHE</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>6h</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>mysql.global.variables[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[MySQL] Instance '{$DBS_MYSQL_INSTANCE}': Version</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>mysql.version[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    <delay>1h</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Version of MySQL instance.</description>
                    <applications>
                        <application>
                            <name>MySQL: Info</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1 and {strlen()}&gt;0</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>Version of MySQL has been changed</name>
                            <opdata>(current: {ITEM.VALUE})</opdata>
                            <priority>HIGH</priority>
                            <description>Версия экземпляра MySQL была изменена. Необходимо проверить факт изменения версии, выяснить причину изменения версии (плановый апгрейд и т.п.), передать данные эксперту.</description>
                            <type>MULTIPLE</type>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>MySQL</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_MYSQL_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>MySQL database discovery</name>
                    <type>DEPENDENT</type>
                    <key>mysql.database.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>[MySQL] Database '{#DBNAME}': Character set</name>
                            <type>DEPENDENT</type>
                            <key>mysql.db.info[{#DBNAME},db_character_set]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <application_prototypes>
                                <application_prototype>
                                    <name>MySQL: Database: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.DBNAME== &quot;{#DBNAME}&quot;)].DB_CHARACTER_SET.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>6h</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mysql.db.info[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[MySQL] Database '{#DBNAME}': Collation name</name>
                            <type>DEPENDENT</type>
                            <key>mysql.db.info[{#DBNAME},db_collation_name]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <application_prototypes>
                                <application_prototype>
                                    <name>MySQL: Database: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.DBNAME== &quot;{#DBNAME}&quot;)].DB_COLLATION_NAME.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>6h</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mysql.db.info[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[MySQL] Database '{#DBNAME}': Size</name>
                            <type>DEPENDENT</type>
                            <key>mysql.db.info[{#DBNAME},db_size]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <units>B</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>MySQL: Database: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.DBNAME== &quot;{#DBNAME}&quot;)].DB_SIZE.first()</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>mysql.db.info[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{nodata({$DBS_MYSQL_DB_NODATA_WARN:&quot;{#DBNAME}&quot;})}=1</expression>
                                    <name>Database '{#DBNAME}' is not available</name>
                                    <priority>HIGH</priority>
                                    <description>Более {$DBS_MYSQL_DB_NODATA_WARN} (минут) не поступает информация о базе данных '{#DBNAME}'. Зайдите на сервер и проверьте наличие этой базы данных, возможно она была удалена. Доведите информацию до эксперта.</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>MySQL</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{$DBS_MYSQL_INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&gt;{$DBS_MYSQL_DBSIZE_CRIT:&quot;{#DBNAME}&quot;}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&lt;={$DBS_MYSQL_DBSIZE_CRIT:&quot;{#DBNAME}&quot;}</recovery_expression>
                                    <name>Size of database '{#DBNAME}' has increased</name>
                                    <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_MYSQL_DBSIZE_CRIT:&quot;{#DBNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                                    <priority>HIGH</priority>
                                    <description>Размер базы данных '{#DBNAME}' превысил порог {$DBS_MYSQL_DBSIZE_CRIT:&quot;{#DBNAME}&quot;}.&#13;
Необходимо довести информацию до эксперта для дальнейшего анализа состояния базы данных.</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>MySQL</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{$DBS_MYSQL_INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&gt;{$DBS_MYSQL_DBSIZE_WARN:&quot;{#DBNAME}&quot;}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&lt;={$DBS_MYSQL_DBSIZE_WARN:&quot;{#DBNAME}&quot;}</recovery_expression>
                                    <name>Size of database '{#DBNAME}' has increased</name>
                                    <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_MYSQL_DBSIZE_WARN:&quot;{#DBNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                                    <priority>WARNING</priority>
                                    <description>Размер базы данных '{#DBNAME}' превысил порог {$DBS_MYSQL_DBSIZE_WARN:&quot;{#DBNAME}&quot;}.&#13;
Необходимо довести информацию до эксперта для дальнейшего анализа состояния базы данных.</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>Size of database '{#DBNAME}' has increased</name>
                                            <expression>{DBS_Template MySQL for Windows:mysql.db.info[{#DBNAME},db_size].last()}&gt;{$DBS_MYSQL_DBSIZE_CRIT:&quot;{#DBNAME}&quot;}</expression>
                                            <recovery_expression>{DBS_Template MySQL for Windows:mysql.db.info[{#DBNAME},db_size].last()}&lt;={$DBS_MYSQL_DBSIZE_CRIT:&quot;{#DBNAME}&quot;}</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>MySQL</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{$DBS_MYSQL_INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>mysql.db.info[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>output = JSON.parse(value).map(function(db){
    return {
        &quot;{#DBNAME}&quot;: db.DBNAME
    }})
return JSON.stringify({&quot;data&quot;: output})</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$DBS_MYSQL_ABORTED_CONN_MAX_WARN}</macro>
                    <value>3</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_CONNECTION_PRC_CRIT}</macro>
                    <value>95</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_CONNECTION_PRC_WARN}</macro>
                    <value>85</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_DBSIZE_CRIT}</macro>
                    <value>70G</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_DBSIZE_WARN}</macro>
                    <value>50G</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_DB_NODATA_WARN}</macro>
                    <value>1h</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_ERROR_LOG}</macro>
                    <value>&quot;C:\Users\All Users\MySQL\MySQL Server 5.7\error.log&quot;</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_HOST}</macro>
                    <value>127.0.0.1</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_INSTANCE}</macro>
                    <value>mysql_3306</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_PING_NODATA_CRIT}</macro>
                    <value>12m</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_PING_NODATA_WARN}</macro>
                    <value>6m</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_PORT}</macro>
                    <value>3306</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_QCACHE_EFFICIENCY_PRC_WARN}</macro>
                    <value>20</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_SLOW_QUERIES_MAX_WARN}</macro>
                    <value>3</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_THREADS_RUNNING_PRC_CRIT}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$DBS_MYSQL_THREADS_RUNNING_PRC_WARN}</macro>
                    <value>80</value>
                </macro>
            </macros>
            <screens>
                <screen>
                    <name>[MySQL] Performance</name>
                    <hsize>2</hsize>
                    <vsize>3</vsize>
                    <screen_items>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>[MySQL] Operations</name>
                                <host>DBS_Template MySQL for Windows</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>[MySQL] Queries</name>
                                <host>DBS_Template MySQL for Windows</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>1</x>
                            <y>0</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>[MySQL] Connections</name>
                                <host>DBS_Template MySQL for Windows</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>[MySQL] Bandwidth</name>
                                <host>DBS_Template MySQL for Windows</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>1</x>
                            <y>1</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>[MySQL]  InnoDB buffer pool</name>
                                <host>DBS_Template MySQL for Windows</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>0</x>
                            <y>2</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                        <screen_item>
                            <resourcetype>0</resourcetype>
                            <style>0</style>
                            <resource>
                                <name>[MySQL] Threads</name>
                                <host>DBS_Template MySQL for Windows</host>
                            </resource>
                            <width>500</width>
                            <height>100</height>
                            <x>1</x>
                            <y>2</y>
                            <colspan>1</colspan>
                            <rowspan>1</rowspan>
                            <elements>0</elements>
                            <valign>0</valign>
                            <halign>0</halign>
                            <dynamic>0</dynamic>
                            <sort_triggers>0</sort_triggers>
                            <url/>
                            <application/>
                            <max_columns>3</max_columns>
                        </screen_item>
                    </screen_items>
                </screen>
            </screens>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>{DBS_Template MySQL for Windows:mysql.status[{$DBS_MYSQL_INSTANCE},qcache_efficiency].avg(30m)}&lt;{$DBS_MYSQL_QCACHE_EFFICIENCY_PRC_WARN} and {DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},query_cache_limit].last()}&gt;0</expression>
            <name>Query cache efficiency is very low</name>
            <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_MYSQL_QCACHE_EFFICIENCY_PRC_WARN}%, alert started: {ITEM.VALUE1})</opdata>
            <url>https://dev.mysql.com/doc/refman/5.7/en/query-cache-status-and-maintenance.html</url>
            <priority>WARNING</priority>
            <description>Процент эффективности кэша запросов, составляет менее {$DBS_MYSQL_QCACHE_EFFICIENCY_PRC_WARN}%, указывает на проблему с производительностью. Постарайтесь сократить набор результатов, создав более строгие запросы. Если это невозможно, Вы можете постепенно увеличивать параметр query_cache_limit, чтобы большее количество ваших наборов результатов действительно попадало в кеш. Увеличивайте query_cache_limit постепенно, сильно высокие значения могут снизить производительность.</description>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>MySQL</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_MYSQL_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template MySQL for Windows:mysql.status[{$DBS_MYSQL_INSTANCE},threads_connected].min(3m)}/{DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections].last()}*100&gt;{$DBS_MYSQL_CONNECTION_PRC_CRIT} and {DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections].last()}&gt;0</expression>
            <name>Too many connections</name>
            <opdata>(current: {ITEM.LASTVALUE1}, max: {ITEM.LASTVALUE2}, alert started {ITEM.VALUE1})</opdata>
            <priority>HIGH</priority>
            <description>Текущее количество открытых соединений очень велико.&#13;
Зайдите в консоль mysql и выполните SHOW PROCESSLIST;&#13;
Проанализируйте кто занимает больше всего соединений, желательно уменьшить их количество. Передайте данные эксперту для анализа.</description>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>MySQL</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_MYSQL_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template MySQL for Windows:mysql.status[{$DBS_MYSQL_INSTANCE},threads_connected].min(3m)}/{DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections].last()}*100&gt;{$DBS_MYSQL_CONNECTION_PRC_WARN} and {DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections].last()}&gt;0</expression>
            <name>Too many connections</name>
            <opdata>(current: {ITEM.LASTVALUE1}, max: {ITEM.LASTVALUE2}, alert started {ITEM.VALUE1})</opdata>
            <priority>WARNING</priority>
            <description>Текущее количество открытых соединений велико.&#13;
Зайдите в консоль mysql и выполните SHOW PROCESSLIST;&#13;
Проанализируйте кто занимает больше всего соединений, желательно уменьшить их количество. Передайте данные эксперту для анализа.</description>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                </dependency>
                <dependency>
                    <name>Too many connections</name>
                    <expression>{DBS_Template MySQL for Windows:mysql.status[{$DBS_MYSQL_INSTANCE},threads_connected].min(3m)}/{DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections].last()}*100&gt;{$DBS_MYSQL_CONNECTION_PRC_CRIT} and {DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections].last()}&gt;0</expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>MySQL</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_MYSQL_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template MySQL for Windows:mysql.status[{$DBS_MYSQL_INSTANCE},threads_running].min(3m)}/{DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections].last()}*100&gt;{$DBS_MYSQL_THREADS_RUNNING_PRC_CRIT} and {DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections].last()}&gt;0 and {DBS_Template MySQL for Windows:mysql.status[{$DBS_MYSQL_INSTANCE},threads_connected].last()}&gt;0</expression>
            <name>Too many threads running</name>
            <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_MYSQL_THREADS_CRIT}, alert started {ITEM.VALUE1})</opdata>
            <priority>HIGH</priority>
            <description>Текущее количество работающих тредов велико.&#13;
Зайдите в консоль mysql и выполните:&#13;
SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST WHERE COMMAND NOT REGEXP '(Daemon|Sleep|Binlog Dump|Binlog Dump GTID)' AND ID != CONNECTION_ID() AND USER NOT REGEXP '(system user)' AND STATE NOT REGEXP '(slave|relay|event)';&#13;
Проанализируйте кто занимает больше всего работающих соединений, желательно уменьшить их количество. Передайте данные эксперту для анализа.</description>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>MySQL</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_MYSQL_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template MySQL for Windows:mysql.status[{$DBS_MYSQL_INSTANCE},threads_running].min(3m)}/{DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections].last()}*100&gt;{$DBS_MYSQL_THREADS_RUNNING_PRC_WARN} and {DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections].last()}&gt;0 and {DBS_Template MySQL for Windows:mysql.status[{$DBS_MYSQL_INSTANCE},threads_connected].last()}&gt;0</expression>
            <name>Too many threads running</name>
            <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_MYSQL_THREADS_WARN}, alert started {ITEM.VALUE1})</opdata>
            <priority>WARNING</priority>
            <description>Текущее количество работающих тредов велико.&#13;
Зайдите в консоль mysql и выполните:&#13;
SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST WHERE COMMAND NOT REGEXP '(Daemon|Sleep|Binlog Dump|Binlog Dump GTID)' AND ID != CONNECTION_ID() AND USER NOT REGEXP '(system user)' AND STATE NOT REGEXP '(slave|relay|event)';&#13;
Проанализируйте кто занимает больше всего работающих соединений, желательно уменьшить их количество. Передайте данные эксперту для анализа.</description>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template MySQL for Windows:mysql.ping[{$DBS_MYSQL_HOST},{$DBS_MYSQL_PORT}].min(#2)}=1</recovery_expression>
                </dependency>
                <dependency>
                    <name>Too many threads running</name>
                    <expression>{DBS_Template MySQL for Windows:mysql.status[{$DBS_MYSQL_INSTANCE},threads_running].min(3m)}/{DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections].last()}*100&gt;{$DBS_MYSQL_THREADS_RUNNING_PRC_CRIT} and {DBS_Template MySQL for Windows:mysql.variable[{$DBS_MYSQL_INSTANCE},max_connections].last()}&gt;0 and {DBS_Template MySQL for Windows:mysql.status[{$DBS_MYSQL_INSTANCE},threads_connected].last()}&gt;0</expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>MySQL</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_MYSQL_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
    </triggers>
    <graphs>
        <graph>
            <name>[MySQL] Bandwidth</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>00AA00</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},bytes_received_rate]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>3333FF</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},bytes_sent_rate]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>[MySQL] Connections</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},aborted_clients_rate]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},aborted_connects_rate]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},connections_rate]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>A54F10</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},max_used_connections]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>[MySQL]  InnoDB buffer pool</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_free]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_pages_total]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_read_requests]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>A54F10</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},innodb_buffer_pool_reads]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>[MySQL] Operations</name>
            <graph_items>
                <graph_item>
                    <color>C80000</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},com_delete_rate]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>0000EE</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},com_insert_rate]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>00C800</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},com_select_rate]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>C800C8</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},com_update_rate]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>[MySQL] Queries</name>
            <graph_items>
                <graph_item>
                    <color>1A7C11</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},queries_rate]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},questions_rate]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},slow_queries_rate]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>[MySQL] Query Cache Performance</name>
            <graph_items>
                <graph_item>
                    <drawtype>GRADIENT_LINE</drawtype>
                    <color>1A7C11</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},qcache_hits]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},qcache_inserts]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F63100</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},qcache_lowmem_prunes]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <name>[MySQL] Threads</name>
            <graph_items>
                <graph_item>
                    <color>A54F10</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},threads_cached]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>FC6EA3</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},threads_connected]</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>6C59DC</color>
                    <item>
                        <host>DBS_Template MySQL for Windows</host>
                        <key>mysql.status[{$DBS_MYSQL_INSTANCE},threads_running]</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
    <value_maps>
        <value_map>
            <name>DBS MySQL (Instance state)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>STOPPED</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>RUNNING</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>RUNNING_BACKUPING</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>RESTORING</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>ERROR</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
