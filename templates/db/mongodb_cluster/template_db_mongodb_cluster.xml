<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
   <version>5.0</version>
   <date>2021-04-01T09:52:18Z</date>
   <groups>
      <group>
         <name>Templates/Databases</name>
      </group>
   </groups>
   <templates>
      <template>
         <template>Template DB MongoDB cluster by Zabbix Agent 2</template>
         <name>Template DB MongoDB cluster by Zabbix Agent 2</name>
         <description>Get MongoDB metrics from plugin for the zabbix-agent2.&#13;
  1. Setup and configure zabbix-agent2 compiled with the MongoDB monitoring plugin.&#13;
  2. Set the {$MONGODB.CONNSTRING} such as &lt;protocol(host:port)&gt; or named session.&#13;
  3. Set the user name and password in host macros ({$MONGODB.USER}, {$MONGODB.PASSWORD}) if you want to override parameters from the Zabbix agent configuration file.&#13;
&#13;
  All sharded Mongodb nodes (mongod) will be discovered with attached template "MongoDB node".&#13;
&#13;
You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/420659-discussion-thread-for-official-zabbix-template-db-mongodb&#13;
&#13;
Template tooling version used: 0.38</description>
         <groups>
            <group>
               <name>Templates/Databases</name>
            </group>
         </groups>
         <applications>
            <application>
               <name>MongoDB sharded cluster</name>
            </application>
            <application>
               <name>Zabbix raw items</name>
            </application>
         </applications>
         <items>
            <item>
               <name>MongoDB cluster: Configserver heartbeat</name>
               <type>DEPENDENT</type>
               <key>mongodb.config_server_heartbeat</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <units>s</units>
               <description>Difference between the latest optime of the CSRS primary that the mongos has seen and cluster time.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JAVASCRIPT</type>
                     <params>data = JSON.parse(value)
return (data["$clusterTime"].clusterTime-data.sharding.lastSeenConfigServerOpTime.ts)/Math.pow(2,32);
</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Connection pool: available</name>
               <type>DEPENDENT</type>
               <key>mongodb.connection_pool.available</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <description>The total number of available outgoing connections from the current mongos instance to other members of the sharded cluster.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.totalAvailable</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.connpool.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Connection pool: client connections</name>
               <type>DEPENDENT</type>
               <key>mongodb.connection_pool.client</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <description>The number of active and stored outgoing synchronous connections from the current mongos instance to other members of the sharded cluster.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.numClientConnections</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.connpool.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Connection pool: created, rate</name>
               <type>DEPENDENT</type>
               <key>mongodb.connection_pool.created.rate</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <value_type>FLOAT</value_type>
               <description>The total number of outgoing connections created per second by the current mongos instance to other members of the sharded cluster.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.totalCreated</params>
                  </step>
                  <step>
                     <type>CHANGE_PER_SECOND</type>
                     <params/>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.connpool.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Connection pool: in use</name>
               <type>DEPENDENT</type>
               <key>mongodb.connection_pool.in_use</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <description>Reports the total number of outgoing connections from the current mongos instance to other members of the sharded cluster set that are currently in use.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.totalInUse</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.connpool.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Connection pool: refreshing</name>
               <type>DEPENDENT</type>
               <key>mongodb.connection_pool.refreshing</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <description>Reports the total number of outgoing connections from the current mongos instance to other members of the sharded cluster that are currently being refreshed.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.totalRefreshing</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.connpool.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Connection pool: scoped</name>
               <type>DEPENDENT</type>
               <key>mongodb.connection_pool.scoped</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <description>Number of active and stored outgoing scoped synchronous connections from the current mongos instance to other members of the sharded cluster.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.numAScopedConnections</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.connpool.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Connections, active</name>
               <type>DEPENDENT</type>
               <key>mongodb.connections.active</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <description>"The number of active client connections to the server. &#13;
Active client connections refers to client connections that currently have operations in progress.&#13;
Available starting in  4.0.7, 0 for older versions."</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.connections.active</params>
                     <error_handler>CUSTOM_VALUE</error_handler>
                     <error_handler_params>0</error_handler_params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Connections, available</name>
               <type>DEPENDENT</type>
               <key>mongodb.connections.available</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <description>"The number of unused incoming connections available."</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.connections.available</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
               <triggers>
                  <trigger>
                     <expression>{max(5m)}&lt;{$MONGODB.CONNS.AVAILABLE.MIN.WARN}</expression>
                     <name>MongoDB cluster: Available connections less then {$MONGODB.CONNS.AVAILABLE.MIN.WARN}</name>
                     <priority>WARNING</priority>
                     <description>"Too few available connections.&#13;
Consider this value in combination with the value of connections current to understand the connection load on the database"</description>
                  </trigger>
               </triggers>
            </item>
            <item>
               <name>MongoDB cluster: Connections, current</name>
               <type>DEPENDENT</type>
               <key>mongodb.connections.current</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <description>"The number of incoming connections from clients to the database server. &#13;
This number includes the current shell session"</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.connections.current</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: New connections, rate</name>
               <type>DEPENDENT</type>
               <key>mongodb.connections.rate</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <value_type>FLOAT</value_type>
               <description>"Rate of all incoming connections created to the server."</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.connections.totalCreated</params>
                  </step>
                  <step>
                     <type>CHANGE_PER_SECOND</type>
                     <params/>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Get mongodb.connpool.stats</name>
               <key>mongodb.connpool.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               <history>0</history>
               <trends>0</trends>
               <status>ENABLED</status>
               <value_type>TEXT</value_type>
               <description>Returns current info about connpool.stats.</description>
               <applications>
                  <application>
                     <name>Zabbix raw items</name>
                  </application>
               </applications>
            </item>
            <item>
               <name>MongoDB cluster: Cursor: open pinned</name>
               <type>DEPENDENT</type>
               <key>mongodb.cursor.open.pinned</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <description>Number of pinned open cursors.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.metrics.cursor.open.pinned</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Cursor: open total</name>
               <type>DEPENDENT</type>
               <key>mongodb.cursor.open.total</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <description>Number of cursors that MongoDB is maintaining for clients.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.metrics.cursor.open.total</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
               <triggers>
                  <trigger>
                     <expression>{min(5m)}&gt;{$MONGODB.CURSOR.OPEN.MAX.WARN}</expression>
                     <name>MongoDB cluster: Too many cursors opened by MongoDB for clients (over {$MONGODB.CURSOR.OPEN.MAX.WARN} in 5m)</name>
                     <priority>WARNING</priority>
                  </trigger>
               </triggers>
            </item>
            <item>
               <name>MongoDB cluster: Cursor: timed out, rate</name>
               <type>DEPENDENT</type>
               <key>mongodb.cursor.timed_out.rate</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <value_type>FLOAT</value_type>
               <description>Number of cursors that time out, per second.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.metrics.cursor.timedOut</params>
                  </step>
                  <step>
                     <type>CHANGE_PER_SECOND</type>
                     <params/>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
               <triggers>
                  <trigger>
                     <expression>{min(5m)}&gt;{$MONGODB.CURSOR.TIMEOUT.MAX.WARN}</expression>
                     <name>MongoDB cluster: Too many cursors are timing out (over {$MONGODB.CURSOR.TIMEOUT.MAX.WARN} per second in 5m)</name>
                     <priority>WARNING</priority>
                  </trigger>
               </triggers>
            </item>
            <item>
               <name>MongoDB cluster: Jumbo chunks</name>
               <key>mongodb.jumbo_chunks.count["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               <history>7d</history>
               <status>ENABLED</status>
               <description>Total number of 'jumbo' chunks in the mongo cluster.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
            </item>
            <item>
               <name>MongoDB cluster: Last seen configserver</name>
               <type>DEPENDENT</type>
               <key>mongodb.last_seen_config_server</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <units>unixtime</units>
               <description>The latest optime of the CSRS primary that the mongos has seen.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JAVASCRIPT</type>
                     <params>data = JSON.parse(value)
return data.sharding.lastSeenConfigServerOpTime.ts/Math.pow(2,32)
</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Architecture</name>
               <type>DEPENDENT</type>
               <key>mongodb.mem.bits</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <units>bit</units>
               <description>A number, either 64 or 32, that indicates whether the MongoDB instance is compiled for 64-bit or 32-bit architecture.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.mem.bits</params>
                  </step>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>3h</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Memory: resident</name>
               <type>DEPENDENT</type>
               <key>mongodb.mem.resident</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <units>B</units>
               <description>Amount of memory currently used by the database process.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.mem.resident</params>
                  </step>
                  <step>
                     <type>MULTIPLIER</type>
                     <params>1048576</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Memory: virtual</name>
               <type>DEPENDENT</type>
               <key>mongodb.mem.virtual</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <units>B</units>
               <description>Amount of virtual memory used by the mongos process.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.mem.virtual</params>
                  </step>
                  <step>
                     <type>MULTIPLIER</type>
                     <params>1048576</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Cursor: open no timeout</name>
               <type>DEPENDENT</type>
               <key>mongodb.metrics.cursor.open.no_timeout</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <description>Number of open cursors with the option DBQuery.Option.noTimeout set to prevent timeout after a period of inactivity.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.metrics.cursor.open.noTimeout</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Bytes in, rate</name>
               <type>DEPENDENT</type>
               <key>mongodb.network.bytes_in.rate</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <value_type>FLOAT</value_type>
               <description>The total number of bytes that the server has received over network connections initiated by clients or other mongod/mongos instances per second.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.network.bytesIn</params>
                  </step>
                  <step>
                     <type>CHANGE_PER_SECOND</type>
                     <params/>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Bytes out, rate</name>
               <type>DEPENDENT</type>
               <key>mongodb.network.bytes_out.rate</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <value_type>FLOAT</value_type>
               <units>Bps</units>
               <description>The total number of bytes that the server has sent over network connections initiated by clients or other mongod/mongos instances per second.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.network.bytesOut</params>
                  </step>
                  <step>
                     <type>CHANGE_PER_SECOND</type>
                     <params/>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Requests, rate</name>
               <type>DEPENDENT</type>
               <key>mongodb.network.numRequests.rate</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <value_type>FLOAT</value_type>
               <units>!Rps</units>
               <description>Number of distinct requests that the server has received per second</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.network.numRequests</params>
                  </step>
                  <step>
                     <type>CHANGE_PER_SECOND</type>
                     <params/>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Operations: command</name>
               <type>DEPENDENT</type>
               <key>mongodb.opcounters.command.rate</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <value_type>FLOAT</value_type>
               <description>"The number of commands issued to the database per second.&#13;
Counts all commands except the write commands: insert, update, and delete."</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.opcounters.command</params>
                  </step>
                  <step>
                     <type>CHANGE_PER_SECOND</type>
                     <params/>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Operations: delete</name>
               <type>DEPENDENT</type>
               <key>mongodb.opcounters.delete.rate</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <value_type>FLOAT</value_type>
               <description>"The number of delete operations the mongos instance per second."</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.opcounters.delete</params>
                  </step>
                  <step>
                     <type>CHANGE_PER_SECOND</type>
                     <params/>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Operations: getmore, rate</name>
               <type>DEPENDENT</type>
               <key>mongodb.opcounters.getmore.rate</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <value_type>FLOAT</value_type>
               <description>"The number of “getmore” operations the mongos per second. This counter can be high even if the query count is low.&#13;
Secondary nodes send getMore operations as part of the replication process."</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.opcounters.getmore</params>
                  </step>
                  <step>
                     <type>CHANGE_PER_SECOND</type>
                     <params/>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Operations: insert, rate</name>
               <type>DEPENDENT</type>
               <key>mongodb.opcounters.insert.rate</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <value_type>FLOAT</value_type>
               <description>"The number of insert operations received the mongos instance per second."</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.opcounters.insert</params>
                  </step>
                  <step>
                     <type>CHANGE_PER_SECOND</type>
                     <params/>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Operations: query, rate</name>
               <type>DEPENDENT</type>
               <key>mongodb.opcounters.query.rate</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <value_type>FLOAT</value_type>
               <description>"The number of queries received the mongos instance per second."</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.opcounters.query</params>
                  </step>
                  <step>
                     <type>CHANGE_PER_SECOND</type>
                     <params/>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Operations: update, rate</name>
               <type>DEPENDENT</type>
               <key>mongodb.opcounters.update.rate</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <value_type>FLOAT</value_type>
               <description>"The number of update operations the mongos instance per second."</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.opcounters.update</params>
                  </step>
                  <step>
                     <type>CHANGE_PER_SECOND</type>
                     <params/>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
            </item>
            <item>
               <name>MongoDB cluster: Ping</name>
               <key>mongodb.ping["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               <delay>30s</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <description>Test if a connection is alive or not.</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <valuemap>
                  <name>Service state</name>
               </valuemap>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>30m</params>
                  </step>
               </preprocessing>
               <triggers>
                  <trigger>
                     <expression>{last()}=0</expression>
                     <name>MongoDB cluster: Connection to mongos proxy is unavailable</name>
                     <priority>HIGH</priority>
                     <description>Connection to mongos proxy instance is currently unavailable.</description>
                  </trigger>
               </triggers>
            </item>
            <item>
               <name>MongoDB cluster: Get server status</name>
               <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               <history>0</history>
               <trends>0</trends>
               <status>ENABLED</status>
               <value_type>TEXT</value_type>
               <description>The mongos statistic</description>
               <applications>
                  <application>
                     <name>Zabbix raw items</name>
                  </application>
               </applications>
            </item>
            <item>
               <name>MongoDB cluster: Uptime</name>
               <type>DEPENDENT</type>
               <key>mongodb.uptime</key>
               <delay>0</delay>
               <history>7d</history>
               <status>ENABLED</status>
               <units>s</units>
               <description>Number of seconds since Mongos server start</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.uptime</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
               <triggers>
                  <trigger>
                     <expression>{last()}&lt;10m</expression>
                     <name>MongoDB cluster: has been restarted (uptime &lt; 10m)</name>
                     <priority>INFO</priority>
                     <description>Uptime is less than 10 minutes</description>
                     <manual_close>YES</manual_close>
                  </trigger>
                  <trigger>
                     <expression>{nodata(10m)}=1</expression>
                     <name>MongoDB cluster: Failed to fetch info data (or no data for 10m)</name>
                     <priority>WARNING</priority>
                     <description>Zabbix has not received data for items for the last 10 minutes</description>
                     <manual_close>YES</manual_close>
                     <dependencies>
                        <dependency>
                           <name>MongoDB cluster: Connection to mongos proxy is unavailable</name>
                           <expression>{Template DB MongoDB cluster by Zabbix Agent 2:mongodb.ping["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"].last()}=0</expression>
                        </dependency>
                     </dependencies>
                  </trigger>
               </triggers>
            </item>
            <item>
               <name>MongoDB cluster: Mongos version</name>
               <type>DEPENDENT</type>
               <key>mongodb.version</key>
               <delay>0</delay>
               <history>7d</history>
               <trends>0</trends>
               <status>ENABLED</status>
               <value_type>CHAR</value_type>
               <description>Version of the Mongos server</description>
               <applications>
                  <application>
                     <name>MongoDB sharded cluster</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>JSONPATH</type>
                     <params>$.version</params>
                  </step>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>3h</params>
                  </step>
               </preprocessing>
               <master_item>
                  <key>mongodb.server.status["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               </master_item>
               <triggers>
                  <trigger>
                     <expression>{diff()}=1 and {strlen()}&gt;0</expression>
                     <name>MongoDB cluster: Version has changed (new version: {ITEM.VALUE})</name>
                     <priority>INFO</priority>
                     <description>MongoDB cluster version has changed. Ack to close.</description>
                     <manual_close>YES</manual_close>
                  </trigger>
               </triggers>
            </item>
         </items>
         <discovery_rules>
            <discovery_rule>
               <name>Config servers discovery</name>
               <type>ZABBIX_PASSIVE</type>
               <key>mongodb.cfg.discovery["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               <delay>30m</delay>
               <description>Discovery shared cluster config servers.</description>
               <item_prototypes/>
               <host_prototypes>
                  <host_prototype>
                     <host>{#HOSTNAME}</host>
                     <name>{#HOSTNAME}</name>
                     <status>ENABLED</status>
                     <group_links>
                        <group_link>
                           <group>
                              <name>Templates/Databases</name>
                           </group>
                        </group_link>
                     </group_links>
                     <group_prototypes>
                        <group_prototype>
                           <name>MongoDB sharded cluster/{#REPLICASET}</name>
                        </group_prototype>
                     </group_prototypes>
                     <templates>
                        <template>
                           <name>Template DB MongoDB node by Zabbix Agent 2</name>
                        </template>
                     </templates>
                     <macros>
                        <macro>
                           <macro>{$MONGODB.CONNSTRING}</macro>
                           <value>{#MONGOD_URI}</value>
                           <description>Connection string in the URI format (password is not used).</description>
                        </macro>
                     </macros>
                  </host_prototype>
               </host_prototypes>
            </discovery_rule>
            <discovery_rule>
               <name>Collection discovery</name>
               <type>ZABBIX_PASSIVE</type>
               <key>mongodb.collections.discovery["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               <delay>30m</delay>
               <filter>
                  <evaltype>AND</evaltype>
                  <conditions>
                     <condition>
                        <macro>{#DBNAME}</macro>
                        <value>{$MONGODB.LLD.FILTER.DB.MATCHES}</value>
                        <formulaid>A</formulaid>
                     </condition>
                     <condition>
                        <macro>{#DBNAME}</macro>
                        <value>{$MONGODB.LLD.FILTER.DB.NOT_MATCHES}</value>
                        <operator>NOT_MATCHES_REGEX</operator>
                        <formulaid>B</formulaid>
                     </condition>
                     <condition>
                        <macro>{#COLLECTION}</macro>
                        <value>{$MONGODB.LLD.FILTER.COLLECTION.MATCHES}</value>
                        <formulaid>C</formulaid>
                     </condition>
                     <condition>
                        <macro>{#COLLECTION}</macro>
                        <value>{$MONGODB.LLD.FILTER.COLLECTION.NOT_MATCHES}</value>
                        <operator>NOT_MATCHES_REGEX</operator>
                        <formulaid>D</formulaid>
                     </condition>
                  </conditions>
               </filter>
               <description>Collect collections metrics.&#13;
Note, depending on the number of DBs and collections this discovery operation may be expensive. Use filters with macros {$MONGODB.LLD.FILTER.DB.MATCHES}, {$MONGODB.LLD.FILTER.DB.NOT_MATCHES}, {$MONGODB.LLD.FILTER.COLLECTION.MATCHES}, {$MONGODB.LLD.FILTER.COLLECTION.NOT_MATCHES}.</description>
               <item_prototypes>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}.{#COLLECTION}: Objects, avg size</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.collection.avg_obj_size["{#DBNAME}","{#COLLECTION}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <value_type>FLOAT</value_type>
                     <units>B</units>
                     <description>The size of the average object in the collection in bytes.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}.{#COLLECTION}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.avgObjSize</params>
                           <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.collection.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}","{#COLLECTION}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}.{#COLLECTION}: Capped</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.collection.capped["{#DBNAME}","{#COLLECTION}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <trends>0</trends>
                     <status>ENABLED</status>
                     <value_type>CHAR</value_type>
                     <description>Whether or not the collection is capped.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}.{#COLLECTION}</name>
                        </application_prototype>
                     </application_prototypes>
                     <valuemap>
                        <name>MongoDB flag</name>
                     </valuemap>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.capped</params>
                        </step>
                        <step>
                           <type>BOOL_TO_DECIMAL</type>
                           <params/>
                        </step>
                        <step>
                           <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                           <params>3h</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.collection.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}","{#COLLECTION}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}.{#COLLECTION}: Objects, count</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.collection.count["{#DBNAME}","{#COLLECTION}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <description>Total number of objects in the collection.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}.{#COLLECTION}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.count</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.collection.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}","{#COLLECTION}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}.{#COLLECTION}: Capped, max size</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.collection.max_size["{#DBNAME}","{#COLLECTION}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <units>B</units>
                     <description>Maximum size of a capped collection in bytes.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}.{#COLLECTION}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.maxSize</params>
                           <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.collection.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}","{#COLLECTION}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}.{#COLLECTION}: Capped, max number</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.collection.max["{#DBNAME}","{#COLLECTION}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <value_type>FLOAT</value_type>
                     <description>Maximum number of documents in a capped collection.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}.{#COLLECTION}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.max</params>
                           <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.collection.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}","{#COLLECTION}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}.{#COLLECTION}: Indexes</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.collection.nindexes["{#DBNAME}","{#COLLECTION}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <description>Total number of indices on the collection.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}.{#COLLECTION}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.nindexes</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.collection.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}","{#COLLECTION}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}.{#COLLECTION}: Size</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.collection.size["{#DBNAME}","{#COLLECTION}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <units>B</units>
                     <description>The total size in bytes of the data in the collection plus the size of every indexes on the mongodb.collection.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}.{#COLLECTION}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.size</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.collection.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}","{#COLLECTION}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}.{#COLLECTION}: Get collection stats {#DBNAME}.{#COLLECTION}</name>
                     <key>mongodb.collection.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}","{#COLLECTION}"]</key>
                     <history>0</history>
                     <trends>0</trends>
                     <status>ENABLED</status>
                     <value_type>TEXT</value_type>
                     <description>Returns a variety of storage statistics for a given collection.</description>
                     <applications>
                        <application>
                           <name>Zabbix raw items</name>
                        </application>
                     </applications>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}.{#COLLECTION}: Storage size</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.collection.storage_size["{#DBNAME}","{#COLLECTION}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <units>B</units>
                     <description>Total storage space allocated to this collection for document storage.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}.{#COLLECTION}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.storageSize</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.collection.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}","{#COLLECTION}"]</key>
                     </master_item>
                  </item_prototype>
               </item_prototypes>
               <host_prototypes/>
            </discovery_rule>
            <discovery_rule>
               <name>Database discovery</name>
               <type>ZABBIX_PASSIVE</type>
               <key>mongodb.db.discovery["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               <delay>30m</delay>
               <filter>
                  <evaltype>AND</evaltype>
                  <conditions>
                     <condition>
                        <macro>{#DBNAME}</macro>
                        <value>{$MONGODB.LLD.FILTER.DB.MATCHES}</value>
                        <formulaid>A</formulaid>
                     </condition>
                     <condition>
                        <macro>{#DBNAME}</macro>
                        <value>{$MONGODB.LLD.FILTER.DB.NOT_MATCHES}</value>
                        <operator>NOT_MATCHES_REGEX</operator>
                        <formulaid>B</formulaid>
                     </condition>
                  </conditions>
               </filter>
               <description>Collect database metrics.&#13;
Note, depending on the number of DBs this discovery operation may be expensive. Use filters with macros {$MONGODB.LLD.FILTER.DB.MATCHES}, {$MONGODB.LLD.FILTER.DB.NOT_MATCHES}.</description>
               <item_prototypes>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}: Size, data</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.db.data_size["{#DBNAME}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <units>B</units>
                     <description>Total size of the data held in this database including the padding factor.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.dataSize</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.db.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}: Extents</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.db.extents["{#DBNAME}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <description>Contains a count of the number of extents in the database across all collections.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.numExtents</params>
                           <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.db.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}: Size, file</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.db.file_size["{#DBNAME}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <units>B</units>
                     <description>Total size of the data held in this database including the padding factor (only available with the mmapv1 storage engine).</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.fileSize</params>
                           <error_handler>DISCARD_VALUE</error_handler>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.db.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}: Size, index</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.db.index_size["{#DBNAME}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <units>B</units>
                     <description>Total size of all indexes created on this database.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.indexSize</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.db.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}: Objects, count</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.db.objects["{#DBNAME}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <description>Number of objects (documents) in the database across all collections.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.objects</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.db.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}: Objects, avg size</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.db.size["{#DBNAME}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <value_type>FLOAT</value_type>
                     <units>B</units>
                     <description>The average size of each document in bytes.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.avgObjSize</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.db.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}"]</key>
                     </master_item>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}: Get db stats {#DBNAME}</name>
                     <key>mongodb.db.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}"]</key>
                     <history>0</history>
                     <trends>0</trends>
                     <status>ENABLED</status>
                     <value_type>TEXT</value_type>
                     <description>Returns statistics reflecting the database system’s state.</description>
                     <applications>
                        <application>
                           <name>Zabbix raw items</name>
                        </application>
                     </applications>
                  </item_prototype>
                  <item_prototype>
                     <name>MongoDB {#DBNAME}: Size, storage</name>
                     <type>DEPENDENT</type>
                     <key>mongodb.db.storage_size["{#DBNAME}"]</key>
                     <delay>0</delay>
                     <history>7d</history>
                     <status>ENABLED</status>
                     <units>B</units>
                     <description>Total amount of space allocated to collections in this database for document storage.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>MongoDB sharded cluster: {#DBNAME}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>JSONPATH</type>
                           <params>$.storageSize</params>
                        </step>
                     </preprocessing>
                     <master_item>
                        <key>mongodb.db.stats["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}","{#DBNAME}"]</key>
                     </master_item>
                  </item_prototype>
               </item_prototypes>
               <host_prototypes/>
               <graph_prototypes>
                  <graph_prototype>
                     <name>MongoDB {#DBNAME}: Disk usage</name>
                     <graph_items>
                        <graph_item>
                           <color>1A7C11</color>
                           <item>
                              <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                              <key>mongodb.db.index_size["{#DBNAME}"]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>1</sortorder>
                           <color>2774A4</color>
                           <item>
                              <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                              <key>mongodb.db.storage_size["{#DBNAME}"]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>2</sortorder>
                           <color>F63100</color>
                           <item>
                              <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                              <key>mongodb.db.file_size["{#DBNAME}"]</key>
                           </item>
                        </graph_item>
                        <graph_item>
                           <sortorder>3</sortorder>
                           <color>A54F10</color>
                           <item>
                              <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                              <key>mongodb.db.data_size["{#DBNAME}"]</key>
                           </item>
                        </graph_item>
                     </graph_items>
                  </graph_prototype>
               </graph_prototypes>
            </discovery_rule>
            <discovery_rule>
               <name>Shards discovery</name>
               <type>ZABBIX_PASSIVE</type>
               <key>mongodb.sh.discovery["{$MONGODB.CONNSTRING}","{$MONGODB.USER}","{$MONGODB.PASSWORD}"]</key>
               <delay>30m</delay>
               <description>Discovery shared cluster hosts.</description>
               <item_prototypes/>
               <host_prototypes>
                  <host_prototype>
                     <host>{#HOSTNAME}</host>
                     <name>{#HOSTNAME}</name>
                     <status>ENABLED</status>
                     <group_links>
                        <group_link>
                           <group>
                              <name>Templates/Databases</name>
                           </group>
                        </group_link>
                     </group_links>
                     <group_prototypes>
                        <group_prototype>
                           <name>MongoDB sharded cluster/{#ID}</name>
                        </group_prototype>
                     </group_prototypes>
                     <templates>
                        <template>
                           <name>Template DB MongoDB node by Zabbix Agent 2</name>
                        </template>
                     </templates>
                     <macros>
                        <macro>
                           <macro>{$MONGODB.CONNSTRING}</macro>
                           <value>{#MONGOD_URI}</value>
                           <description>Connection string in the URI format (password is not used).</description>
                        </macro>
                     </macros>
                  </host_prototype>
               </host_prototypes>
            </discovery_rule>
         </discovery_rules>
         <macros>
            <macro>
               <macro>{$MONGODB.CONNS.AVAILABLE.MIN.WARN}</macro>
               <value>1000</value>
               <description>Minimum number of available connections</description>
            </macro>
            <macro>
               <macro>{$MONGODB.CONNSTRING}</macro>
               <value>tcp://localhost:27017</value>
               <description>Connection string in the URI format (password is not used). This param overwrites a value configured in the "Server" option of the configuration file (if it's set), otherwise, the plugin's default value is used: "tcp://localhost:27017"</description>
            </macro>
            <macro>
               <macro>{$MONGODB.CURSOR.OPEN.MAX.WARN}</macro>
               <value>10000</value>
               <description>Maximum number of open cursors</description>
            </macro>
            <macro>
               <macro>{$MONGODB.CURSOR.TIMEOUT.MAX.WARN}</macro>
               <value>1</value>
               <description>Maximum number of cursors timing out per second</description>
            </macro>
            <macro>
               <macro>{$MONGODB.LLD.FILTER.COLLECTION.MATCHES}</macro>
               <value>.*</value>
               <description>Filter of discoverable collections</description>
            </macro>
            <macro>
               <macro>{$MONGODB.LLD.FILTER.COLLECTION.NOT_MATCHES}</macro>
               <value>CHANGE_IF_NEEDED</value>
               <description>Filter to exclude discovered collections</description>
            </macro>
            <macro>
               <macro>{$MONGODB.LLD.FILTER.DB.MATCHES}</macro>
               <value>.*</value>
               <description>Filter of discoverable databases</description>
            </macro>
            <macro>
               <macro>{$MONGODB.LLD.FILTER.DB.NOT_MATCHES}</macro>
               <value>(admin|config|local)</value>
               <description>Filter to exclude discovered databases</description>
            </macro>
            <macro>
               <macro>{$MONGODB.PASSWORD}</macro>
               <description>MongoDB user password</description>
            </macro>
            <macro>
               <macro>{$MONGODB.USER}</macro>
               <description>MongoDB username</description>
            </macro>
         </macros>
      </template>
   </templates>
   <graphs>
      <graph>
         <name>MongoDB cluster: Connection pool</name>
         <graph_items>
            <graph_item>
               <color>1A7C11</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.connection_pool.available</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>1</sortorder>
               <color>2774A4</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.connection_pool.refreshing</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>2</sortorder>
               <color>F63100</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.connection_pool.in_use</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>3</sortorder>
               <color>A54F10</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.connection_pool.scoped</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>4</sortorder>
               <color>FC6EA3</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.connection_pool.client</key>
               </item>
            </graph_item>
         </graph_items>
      </graph>
      <graph>
         <name>MongoDB cluster: Connections</name>
         <graph_items>
            <graph_item>
               <color>1A7C11</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.connections.available</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>1</sortorder>
               <color>2774A4</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.connections.active</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>2</sortorder>
               <color>F63100</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.connections.current</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>3</sortorder>
               <drawtype>BOLD_LINE</drawtype>
               <color>A54F10</color>
               <yaxisside>RIGHT</yaxisside>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.connections.rate</key>
               </item>
            </graph_item>
         </graph_items>
      </graph>
      <graph>
         <name>MongoDB cluster: Cursors</name>
         <graph_items>
            <graph_item>
               <color>1A7C11</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.cursor.open.total</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>1</sortorder>
               <color>2774A4</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.cursor.open.pinned</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>2</sortorder>
               <color>F63100</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.metrics.cursor.open.no_timeout</key>
               </item>
            </graph_item>
         </graph_items>
      </graph>
      <graph>
         <name>MongoDB cluster: Network</name>
         <graph_items>
            <graph_item>
               <color>1A7C11</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.network.bytes_out.rate</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>1</sortorder>
               <color>2774A4</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.network.bytes_in.rate</key>
               </item>
            </graph_item>
         </graph_items>
      </graph>
      <graph>
         <name>MongoDB cluster: Operations rate</name>
         <graph_items>
            <graph_item>
               <drawtype>BOLD_LINE</drawtype>
               <color>1A7C11</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.opcounters.query.rate</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>1</sortorder>
               <drawtype>BOLD_LINE</drawtype>
               <color>2774A4</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.opcounters.insert.rate</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>2</sortorder>
               <drawtype>BOLD_LINE</drawtype>
               <color>F63100</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.opcounters.getmore.rate</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>3</sortorder>
               <drawtype>BOLD_LINE</drawtype>
               <color>A54F10</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.opcounters.update.rate</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>4</sortorder>
               <drawtype>BOLD_LINE</drawtype>
               <color>FC6EA3</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.opcounters.delete.rate</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>5</sortorder>
               <drawtype>BOLD_LINE</drawtype>
               <color>6C59DC</color>
               <item>
                  <host>Template DB MongoDB cluster by Zabbix Agent 2</host>
                  <key>mongodb.opcounters.command.rate</key>
               </item>
            </graph_item>
         </graph_items>
      </graph>
   </graphs>
   <value_maps>
      <value_map>
         <name>Service state</name>
         <mappings>
            <mapping>
               <value>0</value>
               <newvalue>Down</newvalue>
            </mapping>
            <mapping>
               <value>1</value>
               <newvalue>Up</newvalue>
            </mapping>
         </mappings>
      </value_map>
      <value_map>
         <name>MongoDB flag</name>
         <mappings>
            <mapping>
               <value>0</value>
               <newvalue>False</newvalue>
            </mapping>
            <mapping>
               <value>1</value>
               <newvalue>True</newvalue>
            </mapping>
         </mappings>
      </value_map>
   </value_maps>
</zabbix_export>
