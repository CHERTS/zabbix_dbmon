<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.4</version>
    <date>2020-01-24T08:13:44Z</date>
    <groups>
        <group>
            <name>DBS.Templates/Databases</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>DBS_Template Oracle 11g for Windows</template>
            <name>DBS_Template Oracle 11g for Windows</name>
            <description>Template for monitoring Oracle 11g for Windows</description>
            <groups>
                <group>
                    <name>DBS.Templates/Databases</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Oracle: Instance backup</name>
                </application>
                <application>
                    <name>Oracle: Instance info</name>
                </application>
                <application>
                    <name>stubs</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>[Oracle] Get instance '{$DBS_ORACLE_INSTANCE}' archlog dest info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.archlogdest.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>2m</delay>
                    <history>1h</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}' backup: Last archive log backup</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.backup.archivelog[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>30m</delay>
                    <history>30d</history>
                    <units>s</units>
                    <description>Last archive log backup</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance backup</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;{$DBS_ORACLE_ALOG_BACKUP_CRIT}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}&lt;={$DBS_ORACLE_ALOG_BACKUP_CRIT}</recovery_expression>
                            <name>No archived log backups</name>
                            <opdata>(last: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_ALOG_BACKUP_CRIT})</opdata>
                            <priority>HIGH</priority>
                            <description>Очень давно не выполнялся бэкап архивных логов экземпляра. Актуально только если экземпляр в режиме ARCHIVELOG. Необходимо проверить политику резервного копирования, а так же процедуру запуска резервного копирования. Довести информацию до эксперта.</description>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;{$DBS_ORACLE_ALOG_BACKUP_WARN}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}&lt;={$DBS_ORACLE_ALOG_BACKUP_WARN}</recovery_expression>
                            <name>No archived log backups</name>
                            <opdata>(last: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_ALOG_BACKUP_WARN})</opdata>
                            <priority>WARNING</priority>
                            <description>Давно не выполнялся бэкап архивных логов экземпляра. Актуально только если экземпляр в режиме ARCHIVELOG. Необходимо проверить политику резервного копирования, а так же процедуру запуска резервного копирования. Довести информацию до эксперта.</description>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>No archived log backups</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.backup.archivelog[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;{$DBS_ORACLE_ALOG_BACKUP_CRIT}</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.backup.archivelog[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&lt;={$DBS_ORACLE_ALOG_BACKUP_CRIT}</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}' backup: Last control file backup</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.backup.cf[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>2h</delay>
                    <history>30d</history>
                    <units>s</units>
                    <description>Last control file backup</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance backup</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;{$DBS_ORACLE_CF_BACKUP_CRIT}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}&lt;={$DBS_ORACLE_CF_BACKUP_CRIT}</recovery_expression>
                            <name>No control file backups</name>
                            <opdata>(last: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_CF_BACKUP_CRIT})</opdata>
                            <priority>HIGH</priority>
                            <description>Очень давно не выполнялся бэкап контрол файла (control file) экземпляра. Необходимо проверить политику резервного копирования, а так же процедуру запуска резервного копирования. Довести информацию до эксперта.</description>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;{$DBS_ORACLE_CF_BACKUP_WARN}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}&lt;={$DBS_ORACLE_CF_BACKUP_WARN}</recovery_expression>
                            <name>No control file backups</name>
                            <opdata>(last: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_CF_BACKUP_WARN})</opdata>
                            <priority>WARNING</priority>
                            <description>Давно не выполнялся бэкап контрол файла (control file) экземпляра. Необходимо проверить политику резервного копирования, а так же процедуру запуска резервного копирования. Довести информацию до эксперта.</description>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>No control file backups</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.backup.cf[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;{$DBS_ORACLE_CF_BACKUP_CRIT}</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.backup.cf[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&lt;={$DBS_ORACLE_CF_BACKUP_CRIT}</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}' backup: Last full database backup</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.backup.full[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>1h</delay>
                    <history>30d</history>
                    <units>s</units>
                    <description>Last full database backup</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance backup</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;{$DBS_ORACLE_FULL_BACKUP_CRIT}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}&lt;={$DBS_ORACLE_FULL_BACKUP_CRIT}</recovery_expression>
                            <name>No full database backups</name>
                            <opdata>(last: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_FULL_BACKUP_CRIT})</opdata>
                            <priority>HIGH</priority>
                            <description>Очень давно не выполнялся полный бэкап экземпляра. Необходимо проверить политику резервного копирования, а так же процедуру запуска резервного копирования. Довести информацию до эксперта.</description>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{last()}&gt;{$DBS_ORACLE_FULL_BACKUP_WARN}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}&lt;={$DBS_ORACLE_FULL_BACKUP_WARN}</recovery_expression>
                            <name>No full database backups</name>
                            <opdata>(last: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_FULL_BACKUP_WARN})</opdata>
                            <priority>WARNING</priority>
                            <description>Давно не выполнялся полный бэкап экземпляра. Необходимо проверить политику резервного копирования, а так же процедуру запуска резервного копирования. Довести информацию до эксперта.</description>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>No full database backups</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.backup.full[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;{$DBS_ORACLE_FULL_BACKUP_CRIT}</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.backup.full[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&lt;={$DBS_ORACLE_FULL_BACKUP_CRIT}</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}' backup: Last incremental database backup</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.backup.incr[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>30m</delay>
                    <history>30d</history>
                    <units>s</units>
                    <description>Last incremental database backup</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance backup</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}' backup: Total incremental database backup</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.backup.incr_file_num[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>30m</delay>
                    <history>30d</history>
                    <description>Total files number of incremental backup</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance backup</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Count bad processes</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.bad_processes[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>2m</delay>
                    <history>30d</history>
                    <description>Number of zombie processes.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{avg(5m)}&gt;{$DBS_ORACLE_COUNT_BAD_PROCESS_CRIT}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{max(5m)}&lt;={$DBS_ORACLE_COUNT_BAD_PROCESS_CRIT}</recovery_expression>
                            <name>Number of zombie processes is too high</name>
                            <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_COUNT_BAD_PROCESS_CRIT}, alert started: {ITEM.VALUE1})</opdata>
                            <priority>HIGH</priority>
                            <description>Количество зомби процессов достигло критического уровня. Выясните какие процессы превратились в зомби, по возможности завершите эти процессы.</description>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{avg(7m)}&gt;{$DBS_ORACLE_COUNT_BAD_PROCESS_WARN}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{max(5m)}&lt;={$DBS_ORACLE_COUNT_BAD_PROCESS_WARN}</recovery_expression>
                            <name>Number of zombie processes is too high</name>
                            <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_COUNT_BAD_PROCESS_WARN}, alert started: {ITEM.VALUE1})</opdata>
                            <priority>WARNING</priority>
                            <description>Количество зомби процессов достигло угрожающего уровня. Выясните какие процессы превратились в зомби, по возможности завершите эти процессы.</description>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Number of zombie processes is too high</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.bad_processes[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].avg(5m)}&gt;{$DBS_ORACLE_COUNT_BAD_PROCESS_CRIT}</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.bad_processes[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(5m)}&lt;={$DBS_ORACLE_COUNT_BAD_PROCESS_CRIT}</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Current DB files</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.dbfiles[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>1h</delay>
                    <history>30d</history>
                    <description>Number of current data files on instance.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Get instance '{$DBS_ORACLE_INSTANCE}' fra info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.fra[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>2m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Get instance '{$DBS_ORACLE_INSTANCE}' info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>2m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Get instance '{$DBS_ORACLE_INSTANCE}' not default parameters info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.parameters[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>6h</delay>
                    <history>1h</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Get instance '{$DBS_ORACLE_INSTANCE}' parameters info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.parameter[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>2m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Get instance '{$DBS_ORACLE_INSTANCE}' patch info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.patch_info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>6h</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Ping</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <history>30d</history>
                    <description>Test connection with an instance of Oracle.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>DBS Oracle (Ping)</name>
                    </valuemap>
                    <triggers>
                        <trigger>
                            <expression>{max(#2)}=0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{min(#2)}=1</recovery_expression>
                            <name>Instance access failed</name>
                            <priority>DISASTER</priority>
                            <description>Тестовое подключение к экземпляру БД Oracle не успешно. Необходимо проверить работу экземпляра БД, далее проверить работу и настройки zabbix-agent.</description>
                            <dependencies>
                                <dependency>
                                    <name>Test connection data not received for more than {$DBS_ORACLE_PING_NODATA_WARN} (minutes).</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].nodata({$DBS_ORACLE_PING_NODATA_WARN})}=1</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{nodata({$DBS_ORACLE_PING_NODATA_CRIT})}=1</expression>
                            <name>Test connection data not received for more than {$DBS_ORACLE_PING_NODATA_CRIT} (minutes).</name>
                            <priority>HIGH</priority>
                            <description>Данные о доступности экземпляра БД Oracle не поступали более {$DBS_ORACLE_PING_NODATA_CRIT} (минут). Необходимо проверить работу экземпляра БД, далее проверить работу и настройки zabbix-agent.</description>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{nodata({$DBS_ORACLE_PING_NODATA_WARN})}=1</expression>
                            <name>Test connection data not received for more than {$DBS_ORACLE_PING_NODATA_WARN} (minutes).</name>
                            <priority>WARNING</priority>
                            <description>Данные о доступности экземпляра БД Oracle не поступали более {$DBS_ORACLE_PING_NODATA_WARN} (минут). Необходимо проверить работу экземпляра БД, далее проверить работу и настройки zabbix-agent.</description>
                            <dependencies>
                                <dependency>
                                    <name>Test connection data not received for more than {$DBS_ORACLE_PING_NODATA_CRIT} (minutes).</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].nodata({$DBS_ORACLE_PING_NODATA_CRIT})}=1</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Size of redo log in last 1 hour</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.redolog_size_per_hour[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>5m</delay>
                    <history>30d</history>
                    <units>B</units>
                    <description>Size of redo log in last 1 hour</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Redo log switch rate</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.redolog_switch_rate[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>10m</delay>
                    <history>30d</history>
                    <description>Redo log switch rate per 1 hour.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Get instance '{$DBS_ORACLE_INSTANCE}' resource info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.resource[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>2m</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Resumable sessions</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.resumable[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>2m</delay>
                    <history>30d</history>
                    <description>Number of resumable sessions.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{last()}&gt;={$DBS_ORACLE_RESUMABLE_COUNT_CRIT}</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}&lt;{$DBS_ORACLE_RESUMABLE_COUNT_CRIT}</recovery_expression>
                            <name>Resumable sessions suspended due to lack of space in tablespace</name>
                            <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_RESUMABLE_COUNT_CRIT}, alert started: {ITEM.VALUE1})</opdata>
                            <priority>DISASTER</priority>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Version</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.instance.version[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>2h</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Version of Oracle instance.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>Version of Oracle has been changed</name>
                            <opdata>(current: {ITEM.VALUE})</opdata>
                            <priority>INFO</priority>
                            <description>Версия экземпляра Oracle была изменена. Необходимо проверить факт изменения версии, выяснить причину изменения версии (плановый апгрейд и т.п.), передать данные эксперту.</description>
                            <type>MULTIPLE</type>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Archiver</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance[{$DBS_ORACLE_INSTANCE},archiver]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>Automatic archiving status:&#13;
- STOPPED&#13;
- STARTED&#13;
- FAILED - Archiver failed to archive a log last time but will try again within 5 minutes</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>DBS Oracle (archiver)</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.ARCHIVER</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>600</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{last()}=3</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}&lt;&gt;3</recovery_expression>
                            <name>Automatic archiving status is failed</name>
                            <opdata>(current: {ITEM.VALUE})</opdata>
                            <priority>DISASTER</priority>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': FRA files</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance[{$DBS_ORACLE_INSTANCE},fra_files]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>Number of files in the flash recovery area.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.FRA_FILE_NUM</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>600</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.fra[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': FRA limit</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance[{$DBS_ORACLE_INSTANCE},fra_limit]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <units>B</units>
                    <description>Maximum amount of disk space (in bytes) that the database can use for the flash recovery area. This is the value specified in the DB_RECOVERY_FILE_DEST_SIZE initialization parameter.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.FRA_SPACE_LIMIT</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.fra[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{diff()}=1</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>Size for FRA has been changed</name>
                            <opdata>(current: {ITEM.VALUE})</opdata>
                            <priority>INFO</priority>
                            <description>Размер области Fast Recovery Area (FRA) был изменен. Необходимо выяснить кто менял размер FRA и какие были причины.</description>
                            <type>MULTIPLE</type>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': FRA location name</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance[{$DBS_ORACLE_INSTANCE},fra_name]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>Location name. This is the value specified in the DB_RECOVERY_FILE_DEST initialization parameter.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.FRA_LOCATION_NAME</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>600</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.fra[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': FRA reclaimable</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance[{$DBS_ORACLE_INSTANCE},fra_reclaimable]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <units>B</units>
                    <description>Total amount of disk space (in bytes) that can be created by deleting obsolete, redundant, and other low priority files from the flash recovery area.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.FRA_SPACE_RECLAIMABLE</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.fra[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': FRA used</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance[{$DBS_ORACLE_INSTANCE},fra_used]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <units>B</units>
                    <description>Amount of disk space (in bytes) used by flash recovery area files created in current and all previous flash recovery areas. Changing flash recovery areas does not reset SPACE_USED to 0.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.FRA_SPACE_USED</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.fra[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': FRA used, %</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance[{$DBS_ORACLE_INSTANCE},fra_used_pct]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.FRA_USED_PCT</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.fra[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Parallel</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance[{$DBS_ORACLE_INSTANCE},parallel]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>Indicates whether the instance is mounted in cluster database mode (YES) or not (NO)</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>DBS Oracle (yes_no)</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.PARALLEL</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>600</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Current running processes</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance[{$DBS_ORACLE_INSTANCE},processes_current]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>Number of current running processes on instance.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.PROCESSES</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.resource[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Current running sessions</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance[{$DBS_ORACLE_INSTANCE},sessions_current]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>Number of current running sessions on instance.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.SESSIONS</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.resource[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Status</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance[{$DBS_ORACLE_INSTANCE},status]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>Status of the instance:&#13;
- STARTED - After STARTUP NOMOUNT&#13;
- MOUNTED - After STARTUP MOUNT or ALTER DATABASE CLOSE&#13;
- OPEN - After STARTUP or ALTER DATABASE OPEN&#13;
- OPEN MIGRATE - After ALTER DATABASE OPEN { UPGRADE | DOWNGRADE }</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>DBS Oracle (instance_status)</name>
                    </valuemap>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.STATUS</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{max(#3)}=1 and {min(#3)}=1</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{last()}&lt;&gt;1</recovery_expression>
                            <name>Database is not mounted</name>
                            <opdata>(current: {ITEM.VALUE1})</opdata>
                            <priority>WARNING</priority>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                        <trigger>
                            <expression>{diff()}=1 and {last()}&lt;5 and {$DBS_ORACLE_DISABLE_INSTANCE_STATUS_ALARM}=0</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>Instance status has been changed</name>
                            <opdata>(current: {ITEM.VALUE})</opdata>
                            <priority>DISASTER</priority>
                            <type>MULTIPLE</type>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}': Uptime</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance[{$DBS_ORACLE_INSTANCE},uptime]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <units>s</units>
                    <description>Instance uptime in second.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.UPTIME</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                    <triggers>
                        <trigger>
                            <expression>{change()}&lt;-20 and {$DBS_ORACLE_DISABLE_INSTANCE_RESTART_ALARM}=0</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>Instance '{$DBS_ORACLE_INSTANCE}' has just been restarted</name>
                            <opdata>(current uptime: {ITEM.LASTVALUE}, alert started: {ITEM.VALUE})</opdata>
                            <priority>DISASTER</priority>
                            <description>Экземпляр был перезапущен. Необходимо убедиться в том, что он действительно был перезапущен, если так, то проверить alert.log на предмет причин перезапуска, уведомить заказчика и передать данные эксперту.</description>
                            <type>MULTIPLE</type>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{$DBS_ORACLE_INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}' parameter: db_files</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},db_files]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>DB_FILES specifies the maximum number of database files that can be opened for this database.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.DB_FILES</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.parameter[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}' parameter: processes</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},processes]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>PROCESSES specifies the maximum number of operating system user processes that can simultaneously connect to Oracle. Its value should allow for all background processes such as locks, job queue processes, and parallel execution processes.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.PROCESSES</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.parameter[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}' parameter: sessions</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},sessions]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <description>SESSIONS specifies the maximum number of sessions that can be created in the system. Because every login requires a session, this parameter effectively determines the maximum number of concurrent users in the system. You should always set this parameter explicitly to a value equivalent to your estimate of the maximum number of concurrent users, plus the number of background processes, plus approximately 10% for recursive sessions.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.SESSIONS</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.parameter[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}' patch: Last patchset action</name>
                    <type>DEPENDENT</type>
                    <key>oracle.patch[{$DBS_ORACLE_INSTANCE},last_patchset_action]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Last patchset action.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.LAST_PATCHSET_ACTION</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.patch_info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}' patch: Last patchset action time</name>
                    <type>DEPENDENT</type>
                    <key>oracle.patch[{$DBS_ORACLE_INSTANCE},last_patchset_action_time]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Last patchset action time.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.LAST_PATCHSET_ACTION_TIME</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.patch_info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}' patch: Last patchset comment</name>
                    <type>DEPENDENT</type>
                    <key>oracle.patch[{$DBS_ORACLE_INSTANCE},last_patchset_comment]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Last patchset comment.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.LAST_PATCHSET_COMMENTS</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.patch_info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Instance '{$DBS_ORACLE_INSTANCE}' patch: Last patchset version</name>
                    <type>DEPENDENT</type>
                    <key>oracle.patch[{$DBS_ORACLE_INSTANCE},last_patchset_version]</key>
                    <delay>0</delay>
                    <history>30d</history>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <description>Last patchset version.</description>
                    <applications>
                        <application>
                            <name>Oracle: Instance info</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <params>$.LAST_PATCHSET_VERSION</params>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>oracle.instance.patch_info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                </item>
                <item>
                    <name>[Oracle] Get instance '{$DBS_ORACLE_INSTANCE}' permanent tablespace info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},0]</key>
                    <delay>5m</delay>
                    <history>1h</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Get instance '{$DBS_ORACLE_INSTANCE}' temporary tablespace info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},1]</key>
                    <delay>5m</delay>
                    <history>1h</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>[Oracle] Get instance '{$DBS_ORACLE_INSTANCE}' undo tablespace info</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},2]</key>
                    <delay>5m</delay>
                    <history>1h</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <applications>
                        <application>
                            <name>stubs</name>
                        </application>
                    </applications>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <name>Oracle archivelog dest discovery</name>
                    <type>DEPENDENT</type>
                    <key>oracle.archlogdest.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>[Oracle] '{#ARLDEST}': Archiver</name>
                            <type>DEPENDENT</type>
                            <key>oracle.archlogdest[{#INSTANCE},{#ARLDEST},archiver]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Archive log dest info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (archive_dest_archiver)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.ARLDEST== &quot;{#ARLDEST}&quot;)].LOG_ARCHIVER.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.archlogdest.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] '{#ARLDEST}': Error</name>
                            <type>DEPENDENT</type>
                            <key>oracle.archlogdest[{#INSTANCE},{#ARLDEST},error]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Archive log dest info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.ARLDEST== &quot;{#ARLDEST}&quot;)].LOG_ERROR.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.archlogdest.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] '{#ARLDEST}': Sequence</name>
                            <type>DEPENDENT</type>
                            <key>oracle.archlogdest[{#INSTANCE},{#ARLDEST},sequence]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Archive log dest info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.ARLDEST== &quot;{#ARLDEST}&quot;)].LOG_SEQUENCE.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED</type>
                                    <params/>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.archlogdest.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] '{#ARLDEST}': Status</name>
                            <type>DEPENDENT</type>
                            <key>oracle.archlogdest[{#INSTANCE},{#ARLDEST},status]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Archive log dest info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (archive_dest_status)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.ARLDEST== &quot;{#ARLDEST}&quot;)].LOG_STATUS.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.archlogdest.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] '{#ARLDEST}': Target</name>
                            <type>DEPENDENT</type>
                            <key>oracle.archlogdest[{#INSTANCE},{#ARLDEST},target]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Archive log dest info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (archive_dest_target)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.ARLDEST== &quot;{#ARLDEST}&quot;)].LOG_TARGET.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.archlogdest.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{DBS_Template Oracle 11g for Windows:oracle.archlogdest[{#INSTANCE},{#ARLDEST},error].strlen()}&gt;0 and {DBS_Template Oracle 11g for Windows:oracle.archlogdest[{#INSTANCE},{#ARLDEST},status].max(#3)}&gt;3 and {DBS_Template Oracle 11g for Windows:oracle.archlogdest[{#INSTANCE},{#ARLDEST},status].max(#3)}&lt;&gt;5</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.archlogdest[{#INSTANCE},{#ARLDEST},status].max(#2)}&lt;=3 or {DBS_Template Oracle 11g for Windows:oracle.archlogdest[{#INSTANCE},{#ARLDEST},status].last()}=5</recovery_expression>
                            <name>Error '{#ARLDEST}'</name>
                            <opdata>(current status: {ITEM.LASTVALUE2}): {ITEM.LASTVALUE1}</opdata>
                            <priority>HIGH</priority>
                            <description>Ошибка Archive log destination.</description>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{#INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <master_item>
                        <key>oracle.archlogdest.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>output = JSON.parse(value).map(function(arl){
    return {
        &quot;{#INSTANCE}&quot;: arl.INSTANCE,
        &quot;{#DBNAME}&quot;: arl.DBNAME,
        &quot;{#ARLDEST}&quot;: arl.ARLDEST
    }})
return JSON.stringify({&quot;data&quot;: output})</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <name>Oracle database discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.db.discovery[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>1h</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#DBNAME}</macro>
                                <value>{$DBS_ORACLE_DBNAME_EXCLUDE}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>A</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <item_prototypes>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Current incarnation</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>oracle.db.incarnation[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            <delay>1h</delay>
                            <history>1d</history>
                            <description>Information about current database incarnation.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle][{#INSTANCE}][{#DBNAME}] Get database info</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            <delay>2m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>stubs</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Database size</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>oracle.db.size[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            <delay>1h</delay>
                            <history>1d</history>
                            <units>B</units>
                            <description>Full database size.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}&gt;{$DBS_ORACLE_DBSIZE_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&lt;={$DBS_ORACLE_DBSIZE_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}</recovery_expression>
                                    <name>Size of database '{#DBNAME}' has increased</name>
                                    <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_DBSIZE_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                                    <priority>HIGH</priority>
                                    <description>Размер базы '{#DBNAME}' превышает {$DBS_ORACLE_DBSIZE_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}. Необходима консультация эксперта.</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{last()}&gt;{$DBS_ORACLE_DBSIZE_WARN:&quot;{#INSTANCE}:{#DBNAME}&quot;}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&lt;={$DBS_ORACLE_DBSIZE_WARN:&quot;{#INSTANCE}:{#DBNAME}&quot;}</recovery_expression>
                                    <name>Size of database '{#DBNAME}' has increased</name>
                                    <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_DBSIZE_WARN:&quot;{#INSTANCE}:{#DBNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                                    <priority>WARNING</priority>
                                    <description>Размер базы '{#DBNAME}' превышает {$DBS_ORACLE_DBSIZE_WARN:&quot;{#INSTANCE}:{#DBNAME}&quot;}. Необходима консультация эксперта.</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>Size of database '{#DBNAME}' has increased</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.db.size[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}].last()}&gt;{$DBS_ORACLE_DBSIZE_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.db.size[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}].last()}&lt;={$DBS_ORACLE_DBSIZE_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Controlfile creation date</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},controlfile_created]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <description>Creation date of the control file.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.CONTROLFILE_CREATED</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': DataGuard broker</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},dataguard_broker]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>Indicates whether the Data Guard configuration is being managed by the broker (ENABLED) or not (DISABLED).</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (dataguard_broker)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.DATAGUARD_BROKER</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>DataGuard broker has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>INFO</priority>
                                    <type>MULTIPLE</type>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': DBID</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},dbid]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>Database identifier calculated when the database is created and stored in all file headers.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.DBID</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Database ID has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>INFO</priority>
                                    <type>MULTIPLE</type>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': DBName</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},dbname]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>Name of the database.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (log_mode)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.DBNAME</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Flashback mode</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},flashback_on]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (flashback_on)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.FLASHBACK_ON</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Database flashback mode has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>INFO</priority>
                                    <type>MULTIPLE</type>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Force logging mode</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},force_logging]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>Indicates whether the database is under force logging mode (YES) or not (NO).</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (yes_no)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.FORCE_LOGGING</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Force logging mode has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>INFO</priority>
                                    <type>MULTIPLE</type>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Guard status</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},guard_status]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>Protects data from being changed.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (guard_status)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.GUARD_STATUS</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Database guard mode has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>INFO</priority>
                                    <type>MULTIPLE</type>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Archive log mode</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},log_mode]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>Archive log mode:&#13;
- NOARCHIVELOG&#13;
- ARCHIVELOG&#13;
- MANUAL</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (log_mode)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.LOG_MODE</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}=1 and {last()}&lt;&gt;{$DBS_ORACLE_NOARCHIVELOG:&quot;{#DBNAME}&quot;}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}=2 or {$DBS_ORACLE_NOARCHIVELOG:&quot;{#DBNAME}&quot;}=1</recovery_expression>
                                    <name>Database '{#DBNAME}' is NOARCHIVELOG mode.</name>
                                    <priority>WARNING</priority>
                                    <description>База данных '{#DBNAME}' находиться в режиме NOARCHIVELOG. Уточните у заказчика и эксперта обоснованность использования данного режима.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Database archive log mode has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>INFO</priority>
                                    <type>MULTIPLE</type>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Open mode</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},open_mode]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>Open mode information:&#13;
- MOUNTED&#13;
- READ WRITE&#13;
- READ ONLY</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (open_mode)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.OPEN_MODE</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1 and {$DBS_ORACLE_DISABLE_DB_STATUS_ALARM:&quot;{#INSTANCE}:{#DBNAME}&quot;}=0</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Database status has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>DISASTER</priority>
                                    <description>Статус базы данных '{#DBNAME}' изменился.</description>
                                    <type>MULTIPLE</type>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Platform name</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},platform_name]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>Platform name.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (log_mode)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.PLATFORM_NAME</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Protection mode</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},protection_mode]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>Protection mode currently in effect for the database:&#13;
- MAXIMUM PROTECTION - Database is running in maximized protection mode&#13;
- MAXIMUM AVAILABILITY - Database is running in maximized availability mode&#13;
- RESYNCHRONIZATION - Database is running in resynchronization mode&#13;
- MAXIMUM PERFORMANCE - Database is running in maximized performance mode&#13;
- UNPROTECTED - Database is unprotected (this normally occurs when the primary database is mounted and not open)</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (protection_mode)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.PROTECTION_MODE</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Database protection mode has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>INFO</priority>
                                    <type>MULTIPLE</type>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Resetlogs time</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},resetlogs_time]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <description>Timestamp of open resetlogs.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (log_mode)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.RESETLOGS_TIME</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Database role</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},role]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>Current role of the database.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (database_role)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.DATABASE_ROLE</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Database role has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>INFO</priority>
                                    <description>Роль базы данных '{#DBNAME}' была изменена.</description>
                                    <type>MULTIPLE</type>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] DB '{#DBNAME}': Switchover number</name>
                            <type>DEPENDENT</type>
                            <key>oracle.db[{#INSTANCE},{#DBNAME},switchover]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>Number assigned to the database switchover.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.SWITCHOVER_NUMBER</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>300</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.db.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{DBS_Template Oracle 11g for Windows:oracle.db[{#INSTANCE},{#DBNAME},switchover].diff()}=1 and {DBS_Template Oracle 11g for Windows:oracle.db.incarnation[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE},{#DBNAME}].diff()}=0</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>Database switchover has been performed</name>
                            <opdata>(current: {ITEM.VALUE})</opdata>
                            <priority>INFO</priority>
                            <type>MULTIPLE</type>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Database</tag>
                                    <value>{#DBNAME}</value>
                                </tag>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{#INSTANCE}</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Oracle instance parameters discovery</name>
                    <type>DEPENDENT</type>
                    <key>oracle.instance.parameters.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>[Oracle] Instance '{#INSTANCE}' parameter: {#PARAMETER}</name>
                            <type>DEPENDENT</type>
                            <key>oracle.instance_parameter[{#INSTANCE},{#PARAMETER}]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <applications>
                                <application>
                                    <name>Oracle: Instance info</name>
                                </application>
                            </applications>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.PARAMETER== &quot;{#PARAMETER}&quot;)].PVALUE.first()</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.instance.parameters[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>oracle.instance.parameters[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>output = JSON.parse(value).map(function(param){
    return {
        &quot;{#INSTANCE}&quot;: param.INSTANCE,
        &quot;{#PARAMETER}&quot;: param.PARAMETER
    }})
return JSON.stringify({&quot;data&quot;: output})</params>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <name>Oracle permanent tablespace discovery</name>
                    <type>DEPENDENT</type>
                    <key>oracle.permanent.tablespace.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>[Oracle] Tablespace '{#TSNAME}': Data file number</name>
                            <type>DEPENDENT</type>
                            <key>oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},df_number]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>The number of data files in the tablespace.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, TBS: {#TSNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].DF_NUMBER.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},0]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Number of datafile in tablespace '{#TSNAME}' has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>INFO</priority>
                                    <description>Количество дата-файлов в табличном пространстве '{#TSNAME}' было изменено. Проверьте, что было выполнено - добавление файлов или удаление. Доведите информацию до эксперта.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>Tablespace '{#TSNAME}' is not available</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Tablespace</tag>
                                            <value>{#TSNAME}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Tablespace '{#TSNAME}': File free space</name>
                            <type>DEPENDENT</type>
                            <key>oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filefreespace]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <units>B</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, TBS: {#TSNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].TS_FILE_FREE_SPACE.first()</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},0]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Tablespace '{#TSNAME}': Total file size</name>
                            <type>DEPENDENT</type>
                            <key>oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filesize]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <units>B</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, TBS: {#TSNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].TS_FILE_SIZE.first()</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},0]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Tablespace '{#TSNAME}': Total free space</name>
                            <type>CALCULATED</type>
                            <key>oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace]</key>
                            <delay>5m</delay>
                            <history>30d</history>
                            <units>B</units>
                            <params>last(&quot;oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize]&quot;)-(last(&quot;oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filesize]&quot;)-last(&quot;oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filefreespace]&quot;))</params>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, TBS: {#TSNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Tablespace '{#TSNAME}': Max size</name>
                            <type>DEPENDENT</type>
                            <key>oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <units>B</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, TBS: {#TSNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].TS_FILE_MAX_SIZE.first()</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},0]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Tablespace '{#TSNAME}': Status</name>
                            <type>DEPENDENT</type>
                            <key>oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, TBS: {#TSNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (tbs_status)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].TS_STATUS.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},0]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                    <name>Tablespace '{#TSNAME}' is not available</name>
                                    <priority>HIGH</priority>
                                    <description>Данные о табличном пространстве '{#TSNAME}' не поступают более {$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}. Проверьте наличие данного табличного пространства. Доведите информацию до эксперта.</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Tablespace</tag>
                                            <value>{#TSNAME}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Tablespace '{#TSNAME}' status has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>WARNING</priority>
                                    <description>У табличного пространстве '{#TSNAME}' изменился статус. Доведите информацию до эксперта.</description>
                                    <type>MULTIPLE</type>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>Tablespace '{#TSNAME}' is not available</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Tablespace</tag>
                                            <value>{#TSNAME}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Tablespace '{#TSNAME}': Used size</name>
                            <type>CALCULATED</type>
                            <key>oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},usedbytes]</key>
                            <delay>5m</delay>
                            <history>30d</history>
                            <units>B</units>
                            <params>last(&quot;oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filesize]&quot;)-last(&quot;oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filefreespace]&quot;)</params>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, TBS: {#TSNAME}, Info</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&lt;{$DBS_ORACLE_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} and {DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize].last()}&gt;0 and {DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},usedbytes].last()}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&gt;{$DBS_ORACLE_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} or {DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=2 or {DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=3</recovery_expression>
                            <name>Free space in tablespace '{#TSNAME}'</name>
                            <opdata>(free: {ITEM.LASTVALUE1}, maxsize: {ITEM.LASTVALUE2}, threshold: {$DBS_ORACLE_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                            <priority>HIGH</priority>
                            <description>Свободное место в табличном пространстве '{#TSNAME}' составляет менее {$DBS_ORACLE_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}. Необходимо расширить один из файлов в табличном пространстве или добавить новый.</description>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Tablespace '{#TSNAME}' is not available</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Database</tag>
                                    <value>{#DBNAME}</value>
                                </tag>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{#INSTANCE}</value>
                                </tag>
                                <tag>
                                    <tag>Tablespace</tag>
                                    <value>{#TSNAME}</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&lt;{$DBS_ORACLE_TBS_FREESPACE_MB_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} and {DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize].last()}&gt;0 and {DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},usedbytes].last()}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&gt;{$DBS_ORACLE_TBS_FREESPACE_MB_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} or {DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=2 or {DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=3</recovery_expression>
                            <name>Free space in tablespace '{#TSNAME}'</name>
                            <opdata>(free: {ITEM.LASTVALUE1}, maxsize: {ITEM.LASTVALUE2}, threshold: {$DBS_ORACLE_TBS_FREESPACE_MB_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                            <priority>WARNING</priority>
                            <description>Свободное место в табличном пространстве '{#TSNAME}' составляет менее {$DBS_ORACLE_TBS_FREESPACE_MB_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}. Необходимо расширить один из файлов в табличном пространстве или добавить новый.</description>
                            <dependencies>
                                <dependency>
                                    <name>Free space in tablespace '{#TSNAME}'</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&lt;{$DBS_ORACLE_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} and {DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize].last()}&gt;0 and {DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},usedbytes].last()}&gt;0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&gt;{$DBS_ORACLE_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} or {DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=2 or {DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=3</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Tablespace '{#TSNAME}' is not available</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Database</tag>
                                    <value>{#DBNAME}</value>
                                </tag>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{#INSTANCE}</value>
                                </tag>
                                <tag>
                                    <tag>Tablespace</tag>
                                    <value>{#TSNAME}</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <master_item>
                        <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},0]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>output = JSON.parse(value).map(function(tbs){
    return {
        &quot;{#INSTANCE}&quot;: tbs.INSTANCE,
        &quot;{#DBNAME}&quot;: tbs.DBNAME,
        &quot;{#TSNAME}&quot;: tbs.TSNAME
    }})
return JSON.stringify({&quot;data&quot;: output})</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <name>Oracle standby discovery</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>oracle.standby.discovery[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}]</key>
                    <delay>1h</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>[Oracle][{#INSTANCE}] Get standby lag</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>oracle.standby.lag[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE}]</key>
                            <delay>5m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>stubs</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle][{#INSTANCE}] Get MRP status</name>
                            <type>ZABBIX_ACTIVE</type>
                            <key>oracle.standby.mrp_status[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE}]</key>
                            <delay>2m</delay>
                            <history>1d</history>
                            <trends>0</trends>
                            <value_type>TEXT</value_type>
                            <applications>
                                <application>
                                    <name>stubs</name>
                                </application>
                            </applications>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Standby DB '{#DBNAME}': Apply lag</name>
                            <type>DEPENDENT</type>
                            <key>oracle.standby[{#INSTANCE},{#DBNAME},apply_lag]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <units>s</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Standby</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.APPLY_LAG</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.standby.lag[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{avg({$DBS_ORACLE_APPLY_LAG_CRIT_ALERT:&quot;{#INSTANCE}:{#DBNAME}&quot;})}&gt;={$DBS_ORACLE_APPLY_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;} and {min({$DBS_ORACLE_APPLY_LAG_CRIT_ALERT:&quot;{#INSTANCE}:{#DBNAME}&quot;})}&gt;={$DBS_ORACLE_APPLY_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&lt;{$DBS_ORACLE_APPLY_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}</recovery_expression>
                                    <name>Apply lag is too high</name>
                                    <opdata>(lag: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_APPLY_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                                    <priority>HIGH</priority>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Service</tag>
                                            <value>Standby</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{avg({$DBS_ORACLE_APPLY_LAG_WARN_ALERT:&quot;{#INSTANCE}:{#DBNAME}&quot;})}&gt;={$DBS_ORACLE_APPLY_LAG_WARN:&quot;{#INSTANCE}:{#DBNAME}&quot;} and {min({$DBS_ORACLE_APPLY_LAG_WARN_ALERT:&quot;{#INSTANCE}:{#DBNAME}&quot;})}&gt;={$DBS_ORACLE_APPLY_LAG_WARN:&quot;{#INSTANCE}:{#DBNAME}&quot;}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&lt;{$DBS_ORACLE_APPLY_LAG_WARN:&quot;{#INSTANCE}:{#DBNAME}&quot;}</recovery_expression>
                                    <name>Apply lag is too high</name>
                                    <opdata>(lag: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_APPLY_LAG_WARN:&quot;{#INSTANCE}:{#DBNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                                    <priority>WARNING</priority>
                                    <dependencies>
                                        <dependency>
                                            <name>Apply lag is too high</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.standby[{#INSTANCE},{#DBNAME},apply_lag].avg({$DBS_ORACLE_APPLY_LAG_CRIT_ALERT:&quot;{#INSTANCE}:{#DBNAME}&quot;})}&gt;={$DBS_ORACLE_APPLY_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;} and {DBS_Template Oracle 11g for Windows:oracle.standby[{#INSTANCE},{#DBNAME},apply_lag].min({$DBS_ORACLE_APPLY_LAG_CRIT_ALERT:&quot;{#INSTANCE}:{#DBNAME}&quot;})}&gt;={$DBS_ORACLE_APPLY_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.standby[{#INSTANCE},{#DBNAME},apply_lag].last()}&lt;{$DBS_ORACLE_APPLY_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Service</tag>
                                            <value>Standby</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Standby DB '{#DBNAME}': MRP</name>
                            <type>DEPENDENT</type>
                            <key>oracle.standby[{#INSTANCE},{#DBNAME},mrp_cnt]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>Number of MRP process.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Standby</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.MRP_CNT</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.standby.mrp_status[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{last()}=0 and {$DBS_ORACLE_DISABLE_MRP_ALARM:&quot;{#INSTANCE}:{#DBNAME}&quot;}=0</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&gt;0 or {$DBS_ORACLE_DISABLE_MRP_ALARM:&quot;{#INSTANCE}:{#DBNAME}&quot;}=1</recovery_expression>
                                    <name>MRP process is Down or Blocked</name>
                                    <priority>HIGH</priority>
                                    <description>Процесс MRP был остановлен или аварийно завершился. Пока процесс MRP не будет запущен, резервная база будет не актуальна.</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Service</tag>
                                            <value>Standby</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Standby DB '{#DBNAME}': MRP status</name>
                            <type>DEPENDENT</type>
                            <key>oracle.standby[{#INSTANCE},{#DBNAME},mrp_status]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>Current MRP process status:&#13;
- UNUSED - No active process&#13;
- ALLOCATED - Process is active but not currently connected to a primary database&#13;
- CONNECTED - Network connection established to a primary database&#13;
- ATTACHED - Process is actively attached and communicating to a primary database&#13;
- IDLE - Process is not performing any activities&#13;
- ERROR - Process has failed&#13;
- OPENING - Process is opening the archived redo log&#13;
- CLOSING - Process has completed archival and is closing the archived redo log&#13;
- WRITING - Process is actively writing redo data to the archived redo log&#13;
- RECEIVING - Process is receiving network communication&#13;
- ANNOUNCING - Process is announcing the existence of a potential dependent archived redo log&#13;
- REGISTERING - Process is registering the existence of a completed dependent archived redo log&#13;
- WAIT_FOR_LOG - Process is waiting for the archived redo log to be completed&#13;
- WAIT_FOR_GAP - Process is waiting for the archive gap to be resolved&#13;
- APPLYING_LOG - Process is actively applying the archived redo log to the standby database</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Standby</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (standby_status)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.MRP_STATUS</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.standby.mrp_status[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Standby DB '{#DBNAME}': Transport lag</name>
                            <type>DEPENDENT</type>
                            <key>oracle.standby[{#INSTANCE},{#DBNAME},transport_lag]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <units>s</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Standby</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$.TRANSPORT_LAG</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.standby.lag[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{#INSTANCE},{$DBS_ORACLE_MODE}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{avg({$DBS_ORACLE_TRANSPORT_LAG_CRIT_ALERT:&quot;{#INSTANCE}:{#DBNAME}&quot;})}&gt;={$DBS_ORACLE_TRANSPORT_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;} and {min({$DBS_ORACLE_TRANSPORT_LAG_CRIT_ALERT:&quot;{#INSTANCE}:{#DBNAME}&quot;})}&gt;={$DBS_ORACLE_TRANSPORT_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&lt;{$DBS_ORACLE_TRANSPORT_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}</recovery_expression>
                                    <name>Transport lag is too high</name>
                                    <opdata>(lag: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_TRANSPORT_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                                    <priority>HIGH</priority>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Service</tag>
                                            <value>Standby</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{avg({$DBS_ORACLE_TRANSPORT_LAG_WARN_ALERT:&quot;{#INSTANCE}:{#DBNAME}&quot;})}&gt;={$DBS_ORACLE_TRANSPORT_LAG_WARN:&quot;{#INSTANCE}:{#DBNAME}&quot;} and {min({$DBS_ORACLE_TRANSPORT_LAG_WARN_ALERT:&quot;{#INSTANCE}:{#DBNAME}&quot;})}&gt;={$DBS_ORACLE_TRANSPORT_LAG_WARN:&quot;{#INSTANCE}:{#DBNAME}&quot;}</expression>
                                    <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                                    <recovery_expression>{last()}&lt;{$DBS_ORACLE_TRANSPORT_LAG_WARN:&quot;{#INSTANCE}:{#DBNAME}&quot;}</recovery_expression>
                                    <name>Transport lag is too high</name>
                                    <opdata>(lag: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_TRANSPORT_LAG_WARN:&quot;{#INSTANCE}:{#DBNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                                    <priority>WARNING</priority>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>Transport lag is too high</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.standby[{#INSTANCE},{#DBNAME},transport_lag].avg({$DBS_ORACLE_TRANSPORT_LAG_CRIT_ALERT:&quot;{#INSTANCE}:{#DBNAME}&quot;})}&gt;={$DBS_ORACLE_TRANSPORT_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;} and {DBS_Template Oracle 11g for Windows:oracle.standby[{#INSTANCE},{#DBNAME},transport_lag].min({$DBS_ORACLE_TRANSPORT_LAG_CRIT_ALERT:&quot;{#INSTANCE}:{#DBNAME}&quot;})}&gt;={$DBS_ORACLE_TRANSPORT_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.standby[{#INSTANCE},{#DBNAME},transport_lag].last()}&lt;{$DBS_ORACLE_TRANSPORT_LAG_CRIT:&quot;{#INSTANCE}:{#DBNAME}&quot;}</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Service</tag>
                                            <value>Standby</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                    </item_prototypes>
                </discovery_rule>
                <discovery_rule>
                    <name>Oracle temporary tablespace discovery</name>
                    <type>DEPENDENT</type>
                    <key>oracle.temporary.tablespace.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>[Oracle] Temporary tablespace '{#TSNAME}': Data file number</name>
                            <type>DEPENDENT</type>
                            <key>oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},df_number]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>The number of data files in the temporary tablespace.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Temporary tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].DF_NUMBER.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},1]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Number of datafile in temporary tablespace '{#TSNAME}' has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>INFO</priority>
                                    <description>Количество дата-файлов во временном табличном пространстве '{#TSNAME}' было изменено. Проверьте, что было выполнено - добавление файлов или удаление. Доведите информацию до эксперта.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>Temporary tablespace '{#TSNAME}' is not available</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_TEMP_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Tablespace</tag>
                                            <value>{#TSNAME}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Temporary tablespace '{#TSNAME}': File free space</name>
                            <type>DEPENDENT</type>
                            <key>oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filefreespace]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <units>B</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Temporary tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].TS_FILE_FREE_SPACE.first()</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},1]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Temporary tablespace '{#TSNAME}': Total file size</name>
                            <type>DEPENDENT</type>
                            <key>oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filesize]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <units>B</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Temporary tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].TS_FILE_SIZE.first()</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},1]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Temporary tablespace '{#TSNAME}': Total free space</name>
                            <type>CALCULATED</type>
                            <key>oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace]</key>
                            <delay>5m</delay>
                            <history>30d</history>
                            <units>B</units>
                            <params>last(&quot;oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize]&quot;)-(last(&quot;oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filesize]&quot;)-last(&quot;oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filefreespace]&quot;))</params>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Temporary tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Temporary tablespace '{#TSNAME}': Max size</name>
                            <type>DEPENDENT</type>
                            <key>oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <units>B</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Temporary tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].TS_FILE_MAX_SIZE.first()</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},1]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Temporary tablespace '{#TSNAME}': Status</name>
                            <type>DEPENDENT</type>
                            <key>oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Temporary tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (tbs_status)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].TS_STATUS.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},1]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_TEMP_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                    <name>Temporary tablespace '{#TSNAME}' is not available</name>
                                    <priority>HIGH</priority>
                                    <description>Данные о временном табличном пространстве '{#TSNAME}' не поступают более {$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}. Проверьте наличие данного табличного пространства. Доведите информацию до эксперта.</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Tablespace</tag>
                                            <value>{#TSNAME}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Temporary tablespace '{#TSNAME}' status has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>WARNING</priority>
                                    <description>У временного табличного пространстве '{#TSNAME}' изменился статус. Доведите информацию до эксперта.</description>
                                    <type>MULTIPLE</type>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>Temporary tablespace '{#TSNAME}' is not available</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_TEMP_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Tablespace</tag>
                                            <value>{#TSNAME}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Temporary tablespace '{#TSNAME}': Used size</name>
                            <type>CALCULATED</type>
                            <key>oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},usedbytes]</key>
                            <delay>5m</delay>
                            <history>30d</history>
                            <units>B</units>
                            <params>last(&quot;oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filesize]&quot;)-last(&quot;oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filefreespace]&quot;)</params>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Temporary tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&lt;{$DBS_ORACLE_TEMP_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} and {DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize].last()}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&gt;={$DBS_ORACLE_TEMP_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} or {DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=2 or {DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=3</recovery_expression>
                            <name>Free space in temporary tablespace '{#TSNAME}'</name>
                            <opdata>(free: {ITEM.LASTVALUE1}, maxsize: {ITEM.LASTVALUE2}, threshold: {$DBS_ORACLE_TEMP_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                            <priority>HIGH</priority>
                            <description>Свободное место во временном табличном пространстве '{#TSNAME}' составляет менее {$DBS_ORACLE_TEMP_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}. Необходимо выяснить запрос который заполняет временное табличное пространство, так же нужно выяснить его параметры и сообщить заказчику. При критической ситуации с заполнением временного табличного пространстве необходимо прервать запрос и сообщить заказчику.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Temporary tablespace '{#TSNAME}' is not available</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_TEMP_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Database</tag>
                                    <value>{#DBNAME}</value>
                                </tag>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{#INSTANCE}</value>
                                </tag>
                                <tag>
                                    <tag>Tablespace</tag>
                                    <value>{#TSNAME}</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&lt;{$DBS_ORACLE_TEMP_TBS_FREESPACE_MB_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} and {DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize].last()}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&gt;={$DBS_ORACLE_TEMP_TBS_FREESPACE_MB_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} or {DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=2 or {DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=3</recovery_expression>
                            <name>Free space in temporary tablespace '{#TSNAME}'</name>
                            <opdata>(free: {ITEM.LASTVALUE1}, maxsize: {ITEM.LASTVALUE2}, threshold: {$DBS_ORACLE_TEMP_TBS_FREESPACE_MB_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                            <priority>WARNING</priority>
                            <description>Свободное место во временном табличном пространстве '{#TSNAME}' составляет менее {$DBS_ORACLE_TEMP_TBS_FREESPACE_MB_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}. Необходимо выяснить запрос который заполняет временное табличное пространство, так же нужно выяснить его параметры и сообщить заказчику. При критической ситуации с заполнением временного табличного пространстве необходимо прервать запрос и сообщить заказчику.</description>
                            <manual_close>YES</manual_close>
                            <dependencies>
                                <dependency>
                                    <name>Free space in temporary tablespace '{#TSNAME}'</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&lt;{$DBS_ORACLE_TEMP_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} and {DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize].last()}&gt;0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&gt;={$DBS_ORACLE_TEMP_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} or {DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=2 or {DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=3</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Temporary tablespace '{#TSNAME}' is not available</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.temporary_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_TEMP_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Database</tag>
                                    <value>{#DBNAME}</value>
                                </tag>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{#INSTANCE}</value>
                                </tag>
                                <tag>
                                    <tag>Tablespace</tag>
                                    <value>{#TSNAME}</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <master_item>
                        <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},1]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>output = JSON.parse(value).map(function(tbs){
    return {
        &quot;{#INSTANCE}&quot;: tbs.INSTANCE,
        &quot;{#DBNAME}&quot;: tbs.DBNAME,
        &quot;{#TSNAME}&quot;: tbs.TSNAME
    }})
return JSON.stringify({&quot;data&quot;: output})</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </discovery_rule>
                <discovery_rule>
                    <name>Oracle undo tablespace discovery</name>
                    <type>DEPENDENT</type>
                    <key>oracle.undo.tablespace.discovery</key>
                    <delay>0</delay>
                    <item_prototypes>
                        <item_prototype>
                            <name>[Oracle] Undo tablespace '{#TSNAME}': Data file number</name>
                            <type>DEPENDENT</type>
                            <key>oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},df_number]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <description>The number of data files in the tablespace.</description>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Undo tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].DF_NUMBER.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},2]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Number of datafile in undo tablespace '{#TSNAME}' has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>INFO</priority>
                                    <description>Количество дата-файлов во undo табличном пространстве '{#TSNAME}' было изменено. Проверьте, что было выполнено - добавление файлов или удаление. Доведите информацию до эксперта.</description>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>Undo tablespace '{#TSNAME}' is not available</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_UNDO_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Tablespace</tag>
                                            <value>{#TSNAME}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Undo tablespace '{#TSNAME}': File free space</name>
                            <type>CALCULATED</type>
                            <key>oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filefreespace]</key>
                            <delay>2m</delay>
                            <history>30d</history>
                            <units>B</units>
                            <params>last(&quot;oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filesize]&quot;)-last(&quot;oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},usedbytes]&quot;)</params>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Undo tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Undo tablespace '{#TSNAME}': Total file size</name>
                            <type>DEPENDENT</type>
                            <key>oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},filesize]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <units>B</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Undo tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].TS_FILE_SIZE.first()</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},2]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Undo tablespace '{#TSNAME}': Total free space</name>
                            <type>CALCULATED</type>
                            <key>oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace]</key>
                            <delay>2m</delay>
                            <history>30d</history>
                            <units>B</units>
                            <params>last(&quot;oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize]&quot;)-last(&quot;oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},usedbytes]&quot;)</params>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Undo tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Undo tablespace '{#TSNAME}': Max size</name>
                            <type>DEPENDENT</type>
                            <key>oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <units>B</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Undo tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].TS_FILE_MAX_SIZE.first()</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},2]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Undo tablespace '{#TSNAME}': Status</name>
                            <type>DEPENDENT</type>
                            <key>oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Undo tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                            <valuemap>
                                <name>DBS Oracle (tbs_status)</name>
                            </valuemap>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].TS_STATUS.first()</params>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <params>600</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},2]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <expression>{nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_UNDO_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                    <name>Undo tablespace '{#TSNAME}' is not available</name>
                                    <priority>HIGH</priority>
                                    <description>Данные о undo табличном пространстве '{#TSNAME}' не поступают более {$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}. Проверьте наличие данного табличного пространства. Доведите информацию до эксперта.</description>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Tablespace</tag>
                                            <value>{#TSNAME}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                                <trigger_prototype>
                                    <expression>{diff()}=1</expression>
                                    <recovery_mode>NONE</recovery_mode>
                                    <name>Undo tablespace '{#TSNAME}' status has been changed</name>
                                    <opdata>(current: {ITEM.VALUE})</opdata>
                                    <priority>WARNING</priority>
                                    <description>У undo табличного пространстве '{#TSNAME}' изменился статус. Доведите информацию до эксперта.</description>
                                    <type>MULTIPLE</type>
                                    <manual_close>YES</manual_close>
                                    <dependencies>
                                        <dependency>
                                            <name>Instance access failed</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                        </dependency>
                                        <dependency>
                                            <name>Undo tablespace '{#TSNAME}' is not available</name>
                                            <expression>{DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_UNDO_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                        </dependency>
                                    </dependencies>
                                    <tags>
                                        <tag>
                                            <tag>Database</tag>
                                            <value>{#DBNAME}</value>
                                        </tag>
                                        <tag>
                                            <tag>DBType</tag>
                                            <value>Oracle</value>
                                        </tag>
                                        <tag>
                                            <tag>Instance</tag>
                                            <value>{#INSTANCE}</value>
                                        </tag>
                                        <tag>
                                            <tag>Tablespace</tag>
                                            <value>{#TSNAME}</value>
                                        </tag>
                                    </tags>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <name>[Oracle] Undo tablespace '{#TSNAME}': Used size</name>
                            <type>DEPENDENT</type>
                            <key>oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},usedbytes]</key>
                            <delay>0</delay>
                            <history>30d</history>
                            <units>B</units>
                            <application_prototypes>
                                <application_prototype>
                                    <name>Oracle: Instance: {#INSTANCE}, DB: {#DBNAME}, Undo tablespace info</name>
                                </application_prototype>
                            </application_prototypes>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <params>$[?(@.TSNAME== &quot;{#TSNAME}&quot;)].TS_USED_BYTES.first()</params>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},2]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <expression>{DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&lt;{$DBS_ORACLE_UNDO_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} and {DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize].last()}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&gt;={$DBS_ORACLE_UNDO_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} or {DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=2 or {DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=3</recovery_expression>
                            <name>Free space in undo tablespace '{#TSNAME}'</name>
                            <opdata>(free: {ITEM.LASTVALUE1}, maxsize: {ITEM.LASTVALUE2}, threshold: {$DBS_ORACLE_UNDO_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                            <priority>HIGH</priority>
                            <description>Свободное место в undo табличном пространстве '{#TSNAME}' составляет менее {$DBS_ORACLE_UNDO_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}. Необходимо выяснить запрос который заполняет табличное пространство, так же нужно выяснить его параметры и сообщить заказчику. Довести информацию до эксперта.</description>
                            <dependencies>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Undo tablespace '{#TSNAME}' is not available</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_UNDO_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Database</tag>
                                    <value>{#DBNAME}</value>
                                </tag>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{#INSTANCE}</value>
                                </tag>
                                <tag>
                                    <tag>Tablespace</tag>
                                    <value>{#TSNAME}</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <expression>{DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&lt;{$DBS_ORACLE_UNDO_TBS_FREESPACE_MB_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} and {DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize].last()}&gt;0</expression>
                            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
                            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&gt;={$DBS_ORACLE_UNDO_TBS_FREESPACE_MB_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} or {DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=2 or {DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=3</recovery_expression>
                            <name>Free space in undo tablespace '{#TSNAME}'</name>
                            <opdata>(free: {ITEM.LASTVALUE1}, maxsize: {ITEM.LASTVALUE2}, threshold: {$DBS_ORACLE_UNDO_TBS_FREESPACE_MB_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}, alert started: {ITEM.VALUE1})</opdata>
                            <priority>WARNING</priority>
                            <description>Свободное место в undo табличном пространстве '{#TSNAME}' составляет менее {$DBS_ORACLE_UNDO_TBS_FREESPACE_MB_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}. Необходимо выяснить запрос который заполняет табличное пространство, так же нужно выяснить его параметры и сообщить заказчику. Довести информацию до эксперта.</description>
                            <dependencies>
                                <dependency>
                                    <name>Free space in undo tablespace '{#TSNAME}'</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&lt;{$DBS_ORACLE_UNDO_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} and {DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},maxsize].last()}&gt;0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},freespace].last()}&gt;={$DBS_ORACLE_UNDO_TBS_FREESPACE_MB_CRIT:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;} or {DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=2 or {DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].last()}=3</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Instance access failed</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                                </dependency>
                                <dependency>
                                    <name>Undo tablespace '{#TSNAME}' is not available</name>
                                    <expression>{DBS_Template Oracle 11g for Windows:oracle.undo_tablespace[{#INSTANCE},{#DBNAME},{#TSNAME},status].nodata({$DBS_ORACLE_TBS_NODATA_WARN:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;})}=1 and {$DBS_ORACLE_DISABLE_NO_UNDO_TBS_ALARM:&quot;{#INSTANCE}:{#DBNAME}:{#TSNAME}&quot;}=0</expression>
                                </dependency>
                            </dependencies>
                            <tags>
                                <tag>
                                    <tag>Database</tag>
                                    <value>{#DBNAME}</value>
                                </tag>
                                <tag>
                                    <tag>DBType</tag>
                                    <value>Oracle</value>
                                </tag>
                                <tag>
                                    <tag>Instance</tag>
                                    <value>{#INSTANCE}</value>
                                </tag>
                                <tag>
                                    <tag>Tablespace</tag>
                                    <value>{#TSNAME}</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <master_item>
                        <key>oracle.tablespace.info[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE},2]</key>
                    </master_item>
                    <preprocessing>
                        <step>
                            <type>JAVASCRIPT</type>
                            <params>output = JSON.parse(value).map(function(tbs){
    return {
        &quot;{#INSTANCE}&quot;: tbs.INSTANCE,
        &quot;{#DBNAME}&quot;: tbs.DBNAME,
        &quot;{#TSNAME}&quot;: tbs.TSNAME
    }})
return JSON.stringify({&quot;data&quot;: output})</params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <params>1h</params>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$DBS_ORACLE_ALOG_BACKUP_CRIT}</macro>
                    <value>16h</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_ALOG_BACKUP_WARN}</macro>
                    <value>12h</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_APPLY_LAG_CRIT}</macro>
                    <value>1h</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_APPLY_LAG_CRIT_ALERT}</macro>
                    <value>6m</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_APPLY_LAG_WARN}</macro>
                    <value>30m</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_APPLY_LAG_WARN_ALERT}</macro>
                    <value>8m</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_CF_BACKUP_CRIT}</macro>
                    <value>4d</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_CF_BACKUP_WARN}</macro>
                    <value>60h</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_COUNT_BAD_PROCESS_CRIT}</macro>
                    <value>10</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_COUNT_BAD_PROCESS_WARN}</macro>
                    <value>7</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_DBNAME_EXCLUDE}</macro>
                    <value>^(excludedbname1|excludedbname2)$</value>
                    <description>List of exclude database name</description>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_DBSIZE_CRIT}</macro>
                    <value>300G</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_DBSIZE_WARN}</macro>
                    <value>100G</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_DISABLE_DB_STATUS_ALARM}</macro>
                    <value>0</value>
                    <description>Set 1 to disable alarm &quot;Database status has been changed&quot;</description>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_DISABLE_INSTANCE_RESTART_ALARM}</macro>
                    <value>0</value>
                    <description>Set 1 to disable alarm &quot;Instance 'orcl' has just been restarted&quot;</description>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_DISABLE_INSTANCE_STATUS_ALARM}</macro>
                    <value>0</value>
                    <description>Set 1 to disable alarm &quot;Instance status has been changed&quot;</description>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_DISABLE_MRP_ALARM}</macro>
                    <value>0</value>
                    <description>Set 1 to disable alarm &quot;MRP process is Down or Blocked&quot;</description>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_DISABLE_NO_TBS_ALARM}</macro>
                    <value>0</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_DISABLE_NO_TEMP_TBS_ALARM}</macro>
                    <value>0</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_DISABLE_NO_UNDO_TBS_ALARM}</macro>
                    <value>0</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_FRA_USED_PRC_CRIT}</macro>
                    <value>80</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_FRA_USED_PRC_WARN}</macro>
                    <value>70</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_FULL_BACKUP_CRIT}</macro>
                    <value>14d</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_FULL_BACKUP_WARN}</macro>
                    <value>180h</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_HOST}</macro>
                    <value>127.0.0.1</value>
                    <description>Instance address (ip address or dns)</description>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_INCR_BACKUP_CRIT}</macro>
                    <value>4d</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_INCR_BACKUP_WARN}</macro>
                    <value>60h</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_INSTANCE}</macro>
                    <value>orcl</value>
                    <description>Instance name</description>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_MODE}</macro>
                    <value>0</value>
                    <description>0 - OCI_DEFAULT, 1 - OCI_SYSDBA, 2 - OCI_SYSOPER, 3 - OCI_SYSASM, 4 - OCI_SYSDGD</description>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_NOARCHIVELOG}</macro>
                    <value>0</value>
                    <description>Set 1 to disable alarm &quot;Database 'XXX' is NOARCHIVELOG mode.&quot;</description>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_PING_NODATA_CRIT}</macro>
                    <value>12m</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_PING_NODATA_WARN}</macro>
                    <value>6m</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_PORT}</macro>
                    <value>1521</value>
                    <description>Database port</description>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_PROCESSES_PRC_CRIT}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_PROCESSES_PRC_WARN}</macro>
                    <value>80</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_REDOLOG_SW_RATE_CRIT}</macro>
                    <value>12</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_REDOLOG_SW_RATE_WARN}</macro>
                    <value>8</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_RESUMABLE_COUNT_CRIT}</macro>
                    <value>1</value>
                    <description>Max number of resumable sessions</description>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_SESSIONS_PRC_CRIT}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_SESSIONS_PRC_WARN}</macro>
                    <value>80</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_TBS_FREESPACE_MB_CRIT}</macro>
                    <value>5G</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_TBS_FREESPACE_MB_WARN}</macro>
                    <value>7G</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_TBS_NODATA_WARN}</macro>
                    <value>20m</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_TEMP_TBS_FREESPACE_MB_CRIT}</macro>
                    <value>500M</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_TEMP_TBS_FREESPACE_MB_WARN}</macro>
                    <value>700M</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_TOTAL_DBFILE_PRC_WARN}</macro>
                    <value>90</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_TRANSPORT_LAG_CRIT}</macro>
                    <value>1h</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_TRANSPORT_LAG_CRIT_ALERT}</macro>
                    <value>6m</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_TRANSPORT_LAG_WARN}</macro>
                    <value>30m</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_TRANSPORT_LAG_WARN_ALERT}</macro>
                    <value>8m</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_UNDO_TBS_FREESPACE_MB_CRIT}</macro>
                    <value>500M</value>
                </macro>
                <macro>
                    <macro>{$DBS_ORACLE_UNDO_TBS_FREESPACE_MB_WARN}</macro>
                    <value>700M</value>
                </macro>
            </macros>
        </template>
    </templates>
    <triggers>
        <trigger>
            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.dbfiles[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},db_files].last()}*100&gt;={$DBS_ORACLE_TOTAL_DBFILE_PRC_WARN}</expression>
            <name>Current number of data files is near its limit</name>
            <opdata>(current: {ITEM.LASTVALUE1}, max: {ITEM.LASTVALUE2})</opdata>
            <priority>WARNING</priority>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>Oracle</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_ORACLE_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},fra_used_pct].last()}&gt;{$DBS_ORACLE_FRA_USED_PRC_CRIT} and {DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},fra_limit].last()}&gt;0</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},fra_used_pct].last()}&lt;={$DBS_ORACLE_FRA_USED_PRC_CRIT}</recovery_expression>
            <name>FRA usage is to high</name>
            <opdata>(used: {ITEM.LASTVALUE1}%, maxsize: {ITEM.LASTVALUE2}, threshold: {$DBS_ORACLE_FRA_USED_PRC_CRIT}%, alert started: {ITEM.VALUE1}%)</opdata>
            <priority>HIGH</priority>
            <description>Область Fast Recovery Area (FRA) заполнена до критического уровня. Необходимо выяснить чем она заполняется и принять меры по устранению проблемы.</description>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>Oracle</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_ORACLE_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},fra_used_pct].last()}&gt;{$DBS_ORACLE_FRA_USED_PRC_WARN} and {DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},fra_limit].last()}&gt;0</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},fra_used_pct].last()}&lt;={$DBS_ORACLE_FRA_USED_PRC_WARN}</recovery_expression>
            <name>FRA usage is to high</name>
            <opdata>(used: {ITEM.LASTVALUE1}%, maxsize: {ITEM.LASTVALUE2}, threshold: {$DBS_ORACLE_FRA_USED_PRC_WARN}%, alert started: {ITEM.VALUE1}%)</opdata>
            <priority>WARNING</priority>
            <description>Область Fast Recovery Area (FRA) заполнена до угрожающего уровня. Необходимо выяснить чем она заполняется и принять меры по устранению проблемы.</description>
            <dependencies>
                <dependency>
                    <name>FRA usage is to high</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},fra_used_pct].last()}&gt;{$DBS_ORACLE_FRA_USED_PRC_CRIT} and {DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},fra_limit].last()}&gt;0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},fra_used_pct].last()}&lt;={$DBS_ORACLE_FRA_USED_PRC_CRIT}</recovery_expression>
                </dependency>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>Oracle</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_ORACLE_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template Oracle 11g for Windows:oracle.backup.incr[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;{$DBS_ORACLE_INCR_BACKUP_CRIT} and {DBS_Template Oracle 11g for Windows:oracle.backup.incr_file_num[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;0</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.backup.incr[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&lt;={$DBS_ORACLE_INCR_BACKUP_CRIT} and {DBS_Template Oracle 11g for Windows:oracle.backup.incr_file_num[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;=0</recovery_expression>
            <name>No incremental database backups</name>
            <opdata>(last: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_INCR_BACKUP_CRIT})</opdata>
            <priority>HIGH</priority>
            <description>Очень давно не выполнялся инкрементальный бэкап экземпляра. Необходимо проверить политику резервного копирования, а так же процедуру запуска резервного копирования. Довести информацию до эксперта.</description>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>Oracle</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_ORACLE_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template Oracle 11g for Windows:oracle.backup.incr[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;{$DBS_ORACLE_INCR_BACKUP_WARN} and {DBS_Template Oracle 11g for Windows:oracle.backup.incr_file_num[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;0</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.backup.incr[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&lt;={$DBS_ORACLE_INCR_BACKUP_WARN} and {DBS_Template Oracle 11g for Windows:oracle.backup.incr_file_num[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;=0</recovery_expression>
            <name>No incremental database backups</name>
            <opdata>(last: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_INCR_BACKUP_WARN})</opdata>
            <priority>WARNING</priority>
            <description>Давно не выполнялся инкрементальный бэкап экземпляра. Необходимо проверить политику резервного копирования, а так же процедуру запуска резервного копирования. Довести информацию до эксперта.</description>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                </dependency>
                <dependency>
                    <name>No incremental database backups</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.backup.incr[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;{$DBS_ORACLE_INCR_BACKUP_CRIT} and {DBS_Template Oracle 11g for Windows:oracle.backup.incr_file_num[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.backup.incr[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&lt;={$DBS_ORACLE_INCR_BACKUP_CRIT} and {DBS_Template Oracle 11g for Windows:oracle.backup.incr_file_num[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;=0</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>Oracle</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_ORACLE_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.redolog_switch_rate[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;{$DBS_ORACLE_REDOLOG_SW_RATE_CRIT}</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.redolog_switch_rate[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&lt;={$DBS_ORACLE_REDOLOG_SW_RATE_CRIT} or {DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},status].last()}&lt;3</recovery_expression>
            <name>Redolog switch rate per hour is too high</name>
            <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_REDOLOG_SW_RATE_CRIT}, alert started: {ITEM.VALUE1})</opdata>
            <priority>HIGH</priority>
            <description>Генерация redo log черезвычайно высокая, возможно в базу интенсивно пишутся данные.</description>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>Oracle</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_ORACLE_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.redolog_switch_rate[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&gt;{$DBS_ORACLE_REDOLOG_SW_RATE_WARN}</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.redolog_switch_rate[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].last()}&lt;={$DBS_ORACLE_REDOLOG_SW_RATE_WARN} or {DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},status].last()}&lt;3</recovery_expression>
            <name>Redolog switch rate per hour is too high</name>
            <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_REDOLOG_SW_RATE_WARN}, alert started: {ITEM.VALUE1})</opdata>
            <priority>WARNING</priority>
            <description>Генерация redo log слишком высокая, возможно в базу интенсивно пишутся данные.</description>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>Oracle</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_ORACLE_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},processes_current].avg(6m)}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},processes].last()}*100&gt;={$DBS_ORACLE_PROCESSES_PRC_CRIT}</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},processes_current].max(8m)}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},processes].last()}*100&lt;{$DBS_ORACLE_PROCESSES_PRC_CRIT}</recovery_expression>
            <name>Too many processes</name>
            <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_PROCESSES_PRC_CRIT}%, max: {ITEM.LASTVALUE2}, alert started: {ITEM.VALUE1})</opdata>
            <priority>HIGH</priority>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>Oracle</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_ORACLE_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},processes_current].avg(10m)}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},processes].last()}*100&gt;={$DBS_ORACLE_PROCESSES_PRC_WARN}</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},processes_current].max(10m)}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},processes].last()}*100&lt;{$DBS_ORACLE_PROCESSES_PRC_WARN}</recovery_expression>
            <name>Too many processes</name>
            <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_PROCESSES_PRC_WARN}%, max: {ITEM.LASTVALUE2}, alert started: {ITEM.VALUE1})</opdata>
            <priority>WARNING</priority>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                </dependency>
                <dependency>
                    <name>Too many processes</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},processes_current].avg(6m)}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},processes].last()}*100&gt;={$DBS_ORACLE_PROCESSES_PRC_CRIT}</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},processes_current].max(8m)}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},processes].last()}*100&lt;{$DBS_ORACLE_PROCESSES_PRC_CRIT}</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>Oracle</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_ORACLE_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},sessions_current].avg(6m)}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},sessions].last()}*100&gt;={$DBS_ORACLE_SESSIONS_PRC_CRIT}</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},sessions_current].max(8m)}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},sessions].last()}*100&lt;{$DBS_ORACLE_SESSIONS_PRC_CRIT}</recovery_expression>
            <name>Too many sessions</name>
            <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_SESSIONS_PRC_CRIT}%, max: {ITEM.LASTVALUE2}, alert started: {ITEM.VALUE1})</opdata>
            <priority>HIGH</priority>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>Oracle</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_ORACLE_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
        <trigger>
            <expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},sessions_current].avg(10m)}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},sessions].last()}*100&gt;={$DBS_ORACLE_SESSIONS_PRC_WARN}</expression>
            <recovery_mode>RECOVERY_EXPRESSION</recovery_mode>
            <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},sessions_current].max(10m)}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},sessions].last()}*100&lt;{$DBS_ORACLE_SESSIONS_PRC_WARN}</recovery_expression>
            <name>Too many sessions</name>
            <opdata>(current: {ITEM.LASTVALUE1}, threshold: {$DBS_ORACLE_SESSIONS_PRC_WARN}%, max: {ITEM.LASTVALUE2}, alert started: {ITEM.VALUE1})</opdata>
            <priority>WARNING</priority>
            <dependencies>
                <dependency>
                    <name>Instance access failed</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].max(#2)}=0</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance.ping[{$DBS_ORACLE_HOST},{$DBS_ORACLE_PORT},{$DBS_ORACLE_INSTANCE},{$DBS_ORACLE_MODE}].min(#2)}=1</recovery_expression>
                </dependency>
                <dependency>
                    <name>Too many sessions</name>
                    <expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},sessions_current].avg(6m)}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},sessions].last()}*100&gt;={$DBS_ORACLE_SESSIONS_PRC_CRIT}</expression>
                    <recovery_expression>{DBS_Template Oracle 11g for Windows:oracle.instance[{$DBS_ORACLE_INSTANCE},sessions_current].max(8m)}/{DBS_Template Oracle 11g for Windows:oracle.instance_parameter[{$DBS_ORACLE_INSTANCE},sessions].last()}*100&lt;{$DBS_ORACLE_SESSIONS_PRC_CRIT}</recovery_expression>
                </dependency>
            </dependencies>
            <tags>
                <tag>
                    <tag>DBType</tag>
                    <value>Oracle</value>
                </tag>
                <tag>
                    <tag>Instance</tag>
                    <value>{$DBS_ORACLE_INSTANCE}</value>
                </tag>
            </tags>
        </trigger>
    </triggers>
    <value_maps>
        <value_map>
            <name>DBS Oracle (archiver)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>STOPPED</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>STARTED</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>FAILED</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (archive_dest_archiver)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>ARCn</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>FOREGROUND</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>LGWR</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>RFS</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (archive_dest_status)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>VALID</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>INACTIVE</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>DEFERRED</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>ERROR</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>DISABLED</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>BAD PARAM</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>ALTERNATE</newvalue>
                </mapping>
                <mapping>
                    <value>8</value>
                    <newvalue>FULL</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (archive_dest_target)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>PRIMARY</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>STANDBY</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>LOCAL</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>REMOTE</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (database_role)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>SNAPSHOT STANDBY</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>LOGICAL STANDBY</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>PHYSICAL STANDBY</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>PRIMARY</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (dataguard_broker)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>ENABLED</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>DISABLED</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (flashback_on)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>YES</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>NO</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>RESTORE POINT ONLY</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (guard_status)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>ALL</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>STANDBY</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>NONE</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (instance_status)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>STARTED</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>MOUNTED</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>OPEN</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>OPEN MIGRATE</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>STOPPED</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (log_mode)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>NOARCHIVELOG</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>ARCHIVELOG</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>MANUAL</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (open_mode)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>MOUNTED</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>READ WRITE</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>READ ONLY</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>READ ONLY WITH APPLY</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (Ping)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>Down</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>Up</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (protection_mode)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>MAXIMUM PROTECTION</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>MAXIMUM AVAILABILITY</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>RESYNCHRONIZATION</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>MAXIMUM PERFORMANCE</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>UNPROTECTED</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (standby_status)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>UNUSED</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>ALLOCATED</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>CONNECTED</newvalue>
                </mapping>
                <mapping>
                    <value>4</value>
                    <newvalue>ATTACHED</newvalue>
                </mapping>
                <mapping>
                    <value>5</value>
                    <newvalue>IDLE</newvalue>
                </mapping>
                <mapping>
                    <value>6</value>
                    <newvalue>ERROR</newvalue>
                </mapping>
                <mapping>
                    <value>7</value>
                    <newvalue>OPENING</newvalue>
                </mapping>
                <mapping>
                    <value>8</value>
                    <newvalue>CLOSING</newvalue>
                </mapping>
                <mapping>
                    <value>9</value>
                    <newvalue>WRITING</newvalue>
                </mapping>
                <mapping>
                    <value>10</value>
                    <newvalue>RECEIVING</newvalue>
                </mapping>
                <mapping>
                    <value>11</value>
                    <newvalue>ANNOUNCING</newvalue>
                </mapping>
                <mapping>
                    <value>12</value>
                    <newvalue>REGISTERING</newvalue>
                </mapping>
                <mapping>
                    <value>13</value>
                    <newvalue>WAIT_FOR_LOG</newvalue>
                </mapping>
                <mapping>
                    <value>14</value>
                    <newvalue>WAIT_FOR_GAP</newvalue>
                </mapping>
                <mapping>
                    <value>15</value>
                    <newvalue>APPLYING_LOG</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (tbs_status)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>ONLINE</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>OFFLINE</newvalue>
                </mapping>
                <mapping>
                    <value>3</value>
                    <newvalue>READ ONLY</newvalue>
                </mapping>
            </mappings>
        </value_map>
        <value_map>
            <name>DBS Oracle (yes_no)</name>
            <mappings>
                <mapping>
                    <value>0</value>
                    <newvalue>UNKNOWN</newvalue>
                </mapping>
                <mapping>
                    <value>1</value>
                    <newvalue>YES</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>NO</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
